{
  "1": {
    "1": {
      "Name": "Start Task Sequence",
      "Type": "Group",
      "Description": "",
      "Condition": null,
      "Enabled": true,
      "ContinueOnError": true,
      "Steps": {
        "1": {
          "Name": "Main",
          "Type": "Group",
          "Description": "",
          "Condition": null,
          "Enabled": true,
          "ContinueOnError": true,
          "Steps": {
            "1": {
              "Name": "Initialization",
              "Type": "Group",
              "Description": "",
              "Condition": null,
              "Enabled": true,
              "ContinueOnError": false,
              "Steps": {
                "1": {
                  "Name": "Set TS Start Time",
                  "Type": "RunCommandLineAction",
                  "Action": "smsswd.exe /run: %windir%\\System32\\WindowsPowerShell\\v1.0\\powershell.exe -command \"& {$tsenv = New-Object -COMObject Microsoft.SMS.TSEnvironment; $tsenv.Value('SMSTS_StartTSTime') = Get-Date -Format 'dd.MM.yyyy HH:mm:ss'}\"",
                  "Description": "To be used later to determine how long the TS ran",
                  "Conditions": "",
                  "ExecutionPolicy": null,
                  "PackageID": null,
                  "Parameters": null,
                  "RunAsUser": false,
                  "ScriptName": null,
                  "SourceScript": null,
                  "WorkingDirectory": null,
                  "Enabled": true,
                  "OutputVariableName": "",
                  "ContinueOnError": true,
                  "SupportedEnv": "WinPEandFullOS",
                  "SuccessCodes": "0 3010",
                  "Timeout": null
                },
                "2": {
                  "Name": "TSBackgroundInit",
                  "Type": "RunPowerShellScriptAction",
                  "Action": "OSDRunPowerShellScript.exe",
                  "Description": "",
                  "Conditions": "",
                  "ExecutionPolicy": "Bypass",
                  "PackageID": null,
                  "Parameters": "-NumberOfStepsInErrorGroup 4",
                  "RunAsUser": false,
                  "ScriptName": null,
                  "WorkingDirectory": "X:\\",
                  "Enabled": true,
                  "OutputVariableName": "",
                  "ContinueOnError": false,
                  "SupportedEnv": "WinPEandFullOS",
                  "SuccessCodes": "0 3010",
                  "Timeout": null
                },
                "3": {
                  "Name": "TSBConnectionInfo",
                  "Type": "RunCommandLineAction",
                  "Action": "smsswd.exe /run: cmd /c exit \"%TSBConnectionInfo%\"",
                  "Description": "",
                  "Conditions": "",
                  "ExecutionPolicy": null,
                  "PackageID": null,
                  "Parameters": null,
                  "RunAsUser": false,
                  "ScriptName": null,
                  "SourceScript": null,
                  "WorkingDirectory": "X:\\",
                  "Enabled": true,
                  "OutputVariableName": "",
                  "ContinueOnError": false,
                  "SupportedEnv": "WinPEandFullOS",
                  "SuccessCodes": "0 3010",
                  "Timeout": null
                },
                "4": {
                  "Name": "GatherLocal",
                  "Type": "RunPowerShellScriptAction",
                  "Action": "OSDRunPowerShellScript.exe",
                  "Description": "",
                  "Conditions": "",
                  "ExecutionPolicy": "Bypass",
                  "PackageID": null,
                  "Parameters": "",
                  "RunAsUser": false,
                  "ScriptName": null,
                  "WorkingDirectory": "x:\\",
                  "Enabled": true,
                  "OutputVariableName": "",
                  "ContinueOnError": false,
                  "SupportedEnv": "WinPEandFullOS",
                  "SuccessCodes": "0",
                  "Timeout": null
                },
                "5": {
                  "Name": "Set Environment Variables",
                  "Type": "SetDynamicVariablesAction",
                  "Action": "OSDSetDynamicVariables.exe",
                  "Description": "",
                  "Conditions": "",
                  "ExecutionPolicy": null,
                  "PackageID": null,
                  "Parameters": null,
                  "RunAsUser": null,
                  "ScriptName": null,
                  "SourceScript": null,
                  "WorkingDirectory": null,
                  "Enabled": true,
                  "OutputVariableName": null,
                  "ContinueOnError": false,
                  "SupportedEnv": "WinPEandFullOS",
                  "SuccessCodes": null,
                  "Timeout": null
                },
                "6": {
                  "Name": "Set Power Scheme to High Performance",
                  "Type": "RunCommandLineAction",
                  "Action": "smsswd.exe /run: powercfg -setactive 8c5e7fda-e8bf-4a96-9a85-a6e23a8c635c",
                  "Description": "",
                  "Conditions": "",
                  "ExecutionPolicy": null,
                  "PackageID": null,
                  "Parameters": null,
                  "RunAsUser": false,
                  "ScriptName": null,
                  "SourceScript": null,
                  "WorkingDirectory": null,
                  "Enabled": true,
                  "OutputVariableName": "",
                  "ContinueOnError": false,
                  "SupportedEnv": "WinPEandFullOS",
                  "SuccessCodes": "0 3010",
                  "Timeout": null
                },
                "7": {
                  "Name": "Set TSVariable (OSDVer)",
                  "Type": "SetVariableAction",
                  "Action": "tsenv.exe \"OSDVer=v22\" /hiddenflag:False",
                  "Description": "OSDVer contains the version of the task sequence (i.e. 1.0, 2.5, 5.0, etc.) and is used by the script to keep the results from different versions of the sequence separated.",
                  "Conditions": "",
                  "ExecutionPolicy": null,
                  "PackageID": null,
                  "Parameters": null,
                  "RunAsUser": null,
                  "ScriptName": null,
                  "SourceScript": null,
                  "WorkingDirectory": null,
                  "Enabled": true,
                  "OutputVariableName": null,
                  "ContinueOnError": false,
                  "SupportedEnv": "WinPEandFullOS",
                  "SuccessCodes": null,
                  "Timeout": null
                },
                "8": {
                  "Name": "Set TSVariable (OSDBranch)",
                  "Type": "SetVariableAction",
                  "Action": "tsenv.exe \"OSDBranch=DEV\" /hiddenflag:False",
                  "Description": "OSDBranch is a variable I use to identify what stage the sequence is currently (i.e. DEV/QA/PILOT/PROD).  The script will use this to keep results from Development builds from skewing results from Production builds.",
                  "Conditions": "",
                  "ExecutionPolicy": null,
                  "PackageID": null,
                  "Parameters": null,
                  "RunAsUser": null,
                  "ScriptName": null,
                  "SourceScript": null,
                  "WorkingDirectory": null,
                  "Enabled": true,
                  "OutputVariableName": null,
                  "ContinueOnError": false,
                  "SupportedEnv": "WinPEandFullOS",
                  "SuccessCodes": null,
                  "Timeout": null
                },
                "9": {
                  "Name": "Set TSVariable (OSDResultsShare)",
                  "Type": "SetVariableAction",
                  "Action": "tsenv.exe \"OSDResultsShare=P:\\Logs\" /hiddenflag:False",
                  "Description": "The PowerShell script that does the work of collecting the data and writing it out to the CSV file is relatively simple. It pulls in the required variables, calculates the elapsed runtime in minutes and used WMI to query the computer model. This is all the",
                  "Conditions": "",
                  "ExecutionPolicy": null,
                  "PackageID": null,
                  "Parameters": null,
                  "RunAsUser": null,
                  "ScriptName": null,
                  "SourceScript": null,
                  "WorkingDirectory": null,
                  "Enabled": true,
                  "OutputVariableName": null,
                  "ContinueOnError": false,
                  "SupportedEnv": "WinPEandFullOS",
                  "SuccessCodes": null,
                  "Timeout": null
                },
                "10": {
                  "Name": "Debugging",
                  "Type": "Group",
                  "Description": "Only enable if needed for debugging purposes",
                  "Condition": null,
                  "Enabled": true,
                  "ContinueOnError": false,
                  "Steps": {
                    "1": {
                      "Name": "Initialize Variables",
                      "Type": "SetDynamicVariablesAction",
                      "Action": "OSDSetDynamicVariables.exe",
                      "Description": "Update the SMSTS_Build for each Windows Build Version - Temp changed TSDisableProgressUI to false for testing",
                      "Conditions": "",
                      "ExecutionPolicy": null,
                      "PackageID": null,
                      "Parameters": null,
                      "RunAsUser": null,
                      "ScriptName": null,
                      "SourceScript": null,
                      "WorkingDirectory": null,
                      "Enabled": true,
                      "OutputVariableName": null,
                      "ContinueOnError": true,
                      "SupportedEnv": "WinPEandFullOS",
                      "SuccessCodes": null,
                      "Timeout": null
                    },
                    "2": {
                      "Name": "Set Pause",
                      "Type": "SetVariableAction",
                      "Action": "tsenv.exe \"PAUSE=True\" /hiddenflag:False",
                      "Description": "Shows more information about PoSh being run, as well as keeping the PoSh scripts hanging around.",
                      "Conditions": "",
                      "ExecutionPolicy": null,
                      "PackageID": null,
                      "Parameters": null,
                      "RunAsUser": null,
                      "ScriptName": null,
                      "SourceScript": null,
                      "WorkingDirectory": null,
                      "Enabled": true,
                      "OutputVariableName": null,
                      "ContinueOnError": false,
                      "SupportedEnv": "WinPEandFullOS",
                      "SuccessCodes": null,
                      "Timeout": null
                    },
                    "3": {
                      "Name": "Set OSDLogPowerShellParameters",
                      "Type": "SetVariableAction",
                      "Action": "tsenv.exe \"OSDLogPowerShellParameters=True\" /hiddenflag:False",
                      "Description": "Shows more information about PoSh being run, as well as keeping the PoSh scripts hanging around.",
                      "Conditions": "",
                      "ExecutionPolicy": null,
                      "PackageID": null,
                      "Parameters": null,
                      "RunAsUser": null,
                      "ScriptName": null,
                      "SourceScript": null,
                      "WorkingDirectory": null,
                      "Enabled": true,
                      "OutputVariableName": null,
                      "ContinueOnError": false,
                      "SupportedEnv": "WinPEandFullOS",
                      "SuccessCodes": null,
                      "Timeout": null
                    }
                  }
                },
                "11": {
                  "Name": "Prerequisites",
                  "Type": "Group",
                  "Description": "",
                  "Condition": null,
                  "Enabled": true,
                  "ContinueOnError": false,
                  "Steps": {
                    "1": {
                      "Name": "WinPE",
                      "Type": "Group",
                      "Description": "",
                      "Condition": null,
                      "Enabled": true,
                      "ContinueOnError": false,
                      "Steps": {
                        "1": {
                          "Name": "Restart in Windows PE",
                          "Type": "RebootAction",
                          "Action": "smsboot.exe /target:WinPE",
                          "Description": "Restart in WinPE if running through Windows",
                          "Conditions": "---I--If all of these conditions are true:--/I----CRLF----TAB----B--Task Sequence Variable:--/B----CRLF----TAB----TAB--_SMSTSInWinPE equals False",
                          "ExecutionPolicy": null,
                          "PackageID": null,
                          "Parameters": null,
                          "RunAsUser": null,
                          "ScriptName": null,
                          "SourceScript": null,
                          "WorkingDirectory": null,
                          "Enabled": true,
                          "OutputVariableName": null,
                          "ContinueOnError": false,
                          "SupportedEnv": "WinPEandFullOS",
                          "SuccessCodes": null,
                          "Timeout": null
                        },
                        "2": {
                          "Name": "ErrorDialogTimeout",
                          "Type": "SetVariableAction",
                          "Action": "tsenv.exe \"SMSTSErrorDialogTimeout=0\" /hiddenflag:False",
                          "Description": "",
                          "Conditions": "",
                          "ExecutionPolicy": null,
                          "PackageID": null,
                          "Parameters": null,
                          "RunAsUser": null,
                          "ScriptName": null,
                          "SourceScript": null,
                          "WorkingDirectory": null,
                          "Enabled": true,
                          "OutputVariableName": null,
                          "ContinueOnError": false,
                          "SupportedEnv": "WinPEandFullOS",
                          "SuccessCodes": null,
                          "Timeout": null
                        },
                        "3": {
                          "Name": "Netzwerkordner einbinden (Sources)",
                          "Type": "ConnectNetworkFolderAction",
                          "Action": "smsnetuse.exe %SMSConnectNetworkFolderPath%",
                          "Description": "",
                          "Conditions": "",
                          "ExecutionPolicy": null,
                          "PackageID": null,
                          "Parameters": null,
                          "RunAsUser": null,
                          "ScriptName": null,
                          "SourceScript": null,
                          "WorkingDirectory": null,
                          "Enabled": true,
                          "OutputVariableName": null,
                          "ContinueOnError": true,
                          "SupportedEnv": "WinPEandFullOS",
                          "SuccessCodes": null,
                          "Timeout": null
                        },
                        "4": {
                          "Name": "Format and Partition",
                          "Type": "Group",
                          "Description": "",
                          "Condition": null,
                          "Enabled": true,
                          "ContinueOnError": false,
                          "Steps": {
                            "1": {
                              "Name": "Format and Partition Disk (UEFI)",
                              "Type": "PartitionDiskAction",
                              "Action": "osddiskpart.exe",
                              "Description": "For UEFI systems",
                              "Conditions": "--B--Task Sequence Variable:--/B----CRLF----TAB--_SMSTSMediaType notEquals OEMMedia--CRLF----B--Task Sequence Variable:--/B----CRLF----TAB--_SMSTSBootUEFI equals true",
                              "ExecutionPolicy": null,
                              "PackageID": null,
                              "Parameters": null,
                              "RunAsUser": null,
                              "ScriptName": null,
                              "SourceScript": null,
                              "WorkingDirectory": null,
                              "Enabled": true,
                              "OutputVariableName": null,
                              "ContinueOnError": false,
                              "SupportedEnv": "WinPE",
                              "SuccessCodes": null,
                              "Timeout": null
                            },
                            "2": {
                              "Name": "Format and Partition Disk",
                              "Type": "PartitionDiskAction",
                              "Action": "osddiskpart.exe",
                              "Description": "For non-UEFI systems",
                              "Conditions": "--B--Task Sequence Variable:--/B----CRLF----TAB--_SMSTSMediaType notEquals OEMMedia--CRLF----B--Task Sequence Variable:--/B----CRLF----TAB--_SMSTSBootUEFI notEquals true",
                              "ExecutionPolicy": null,
                              "PackageID": null,
                              "Parameters": null,
                              "RunAsUser": null,
                              "ScriptName": null,
                              "SourceScript": null,
                              "WorkingDirectory": null,
                              "Enabled": true,
                              "OutputVariableName": null,
                              "ContinueOnError": false,
                              "SupportedEnv": "WinPE",
                              "SuccessCodes": null,
                              "Timeout": null
                            }
                          }
                        }
                      }
                    },
                    "2": {
                      "Name": "GUI",
                      "Type": "Group",
                      "Description": "",
                      "Condition": null,
                      "Enabled": true,
                      "ContinueOnError": false,
                      "Steps": {
                        "1": {
                          "Name": "SCCMStart (UI++)",
                          "Type": "RunCommandLineAction",
                          "Action": "smsswd.exe /run:KOW00ADB ServiceUI.exe -process:tsbackground.exe UI++64.exe",
                          "Description": "",
                          "Conditions": "",
                          "ExecutionPolicy": null,
                          "PackageID": "KOW00ADB",
                          "Parameters": null,
                          "RunAsUser": false,
                          "ScriptName": null,
                          "SourceScript": null,
                          "WorkingDirectory": null,
                          "Enabled": true,
                          "OutputVariableName": "",
                          "ContinueOnError": false,
                          "SupportedEnv": "WinPEandFullOS",
                          "SuccessCodes": "0 3010",
                          "Timeout": null
                        }
                      }
                    },
                    "3": {
                      "Name": "GatherLocal",
                      "Type": "RunPowerShellScriptAction",
                      "Action": "OSDRunPowerShellScript.exe",
                      "Description": "",
                      "Conditions": "",
                      "ExecutionPolicy": "Bypass",
                      "PackageID": null,
                      "Parameters": "",
                      "RunAsUser": false,
                      "ScriptName": null,
                      "WorkingDirectory": "x:\\",
                      "Enabled": true,
                      "OutputVariableName": "",
                      "ContinueOnError": false,
                      "SupportedEnv": "WinPEandFullOS",
                      "SuccessCodes": "0",
                      "Timeout": null
                    },
                    "4": {
                      "Name": "BitLocker PreProvisioning",
                      "Type": "Group",
                      "Description": "",
                      "Condition": null,
                      "Enabled": true,
                      "ContinueOnError": false,
                      "Steps": {
                        "1": {
                          "Name": "Notebooks",
                          "Type": "Group",
                          "Description": "",
                          "Condition": null,
                          "Enabled": true,
                          "ContinueOnError": false,
                          "Steps": {
                            "1": {
                              "Name": "Pre-provision BitLocker",
                              "Type": "OfflineEnableBitLockerAction",
                              "Action": "OSDOfflineBitlocker.exe /enable  /ignoretpm:True /full:False /crypt:7",
                              "Description": "",
                              "Conditions": "",
                              "ExecutionPolicy": null,
                              "PackageID": null,
                              "Parameters": null,
                              "RunAsUser": null,
                              "ScriptName": null,
                              "SourceScript": null,
                              "WorkingDirectory": null,
                              "Enabled": true,
                              "OutputVariableName": null,
                              "ContinueOnError": false,
                              "SupportedEnv": "WinPE",
                              "SuccessCodes": null,
                              "Timeout": null
                            }
                          }
                        },
                        "2": {
                          "Name": "Vmware",
                          "Type": "Group",
                          "Description": "",
                          "Condition": null,
                          "Enabled": true,
                          "ContinueOnError": false,
                          "Steps": {
                            "1": {
                              "Name": "Pre-provision BitLocker",
                              "Type": "OfflineEnableBitLockerAction",
                              "Action": "OSDOfflineBitlocker.exe /enable  /ignoretpm:True /full:False /crypt:7",
                              "Description": "",
                              "Conditions": "",
                              "ExecutionPolicy": null,
                              "PackageID": null,
                              "Parameters": null,
                              "RunAsUser": null,
                              "ScriptName": null,
                              "SourceScript": null,
                              "WorkingDirectory": null,
                              "Enabled": true,
                              "OutputVariableName": null,
                              "ContinueOnError": false,
                              "SupportedEnv": "WinPE",
                              "SuccessCodes": null,
                              "Timeout": null
                            }
                          }
                        }
                      }
                    }
                  }
                }
              }
            },
            "2": {
              "Name": "01 BIOS Configuration",
              "Type": "Group",
              "Description": "",
              "Condition": null,
              "Enabled": true,
              "ContinueOnError": false,
              "Steps": {
                "1": {
                  "Name": "Status 01 (BIOS Settings)",
                  "Type": "SetVariableAction",
                  "Action": "tsenv.exe \"TSBStatus=General,Status01\" /hiddenflag:False",
                  "Description": "",
                  "Conditions": "",
                  "ExecutionPolicy": null,
                  "PackageID": null,
                  "Parameters": null,
                  "RunAsUser": null,
                  "ScriptName": null,
                  "SourceScript": null,
                  "WorkingDirectory": null,
                  "Enabled": true,
                  "OutputVariableName": null,
                  "ContinueOnError": false,
                  "SupportedEnv": "WinPEandFullOS",
                  "SuccessCodes": null,
                  "Timeout": null
                },
                "2": {
                  "Name": "Module | KOW | BIOS Configuration",
                  "Type": "SubTasksequence",
                  "Description": "BIOS Einstellungen konfigurieren",
                  "Condition": null,
                  "Enabled": true,
                  "SupportedEnv": "WinPEandFullOS",
                  "TSName": "KOW00754, Module | KOW | BIOS Configuration",
                  "TSPackageID": "KOW00754",
                  "TSReferenceApplications": "",
                  "TSReferencePackages": "KOW00BA5",
                  "TSReferenceSoftwareUpdates": "",
                  "ContinueOnError": false,
                  "SubTaskSequence": {
                    "1": {
                      "1": {
                        "Name": "BIOS Settings",
                        "Type": "Group",
                        "Description": "",
                        "Condition": null,
                        "Enabled": true,
                        "ContinueOnError": false,
                        "Steps": {
                          "1": {
                            "Name": "Set Task Sequence Variables",
                            "Type": "Group",
                            "Description": "Actions to capture files and settings in the original operating system",
                            "Condition": null,
                            "Enabled": true,
                            "ContinueOnError": false,
                            "Steps": {
                              "1": {
                                "Name": "Set TS KOWBIOS Start Time",
                                "Type": "RunCommandLineAction",
                                "Action": "smsswd.exe /run: %windir%\\System32\\WindowsPowerShell\\v1.0\\powershell.exe -command \"& {$tsenv = New-Object -COMObject Microsoft.SMS.TSEnvironment; $tsenv.Value('SMSTS_StartTSTime_KOWBIOS') = Get-Date -Format 'dd.MM.yyyy HH:mm:ss'}\"",
                                "Description": "To be used later to determine how long the TS ran",
                                "Conditions": "",
                                "ExecutionPolicy": null,
                                "PackageID": null,
                                "Parameters": null,
                                "RunAsUser": false,
                                "ScriptName": null,
                                "SourceScript": null,
                                "WorkingDirectory": null,
                                "Enabled": true,
                                "OutputVariableName": "",
                                "ContinueOnError": true,
                                "SupportedEnv": "WinPEandFullOS",
                                "SuccessCodes": "0 3010",
                                "Timeout": null
                              }
                            }
                          },
                          "2": {
                            "Name": "Dell",
                            "Type": "Group",
                            "Description": "",
                            "Condition": null,
                            "Enabled": true,
                            "ContinueOnError": false,
                            "Steps": {
                              "1": {
                                "Name": "Script: Get Device Type",
                                "Type": "RunPowerShellScriptAction",
                                "Action": "OSDRunPowerShellScript.exe",
                                "Description": "Ãœber eine WMI Abfrage wird ermittelt, ob es sich um einen Desktop oder Laptop handelt.",
                                "Conditions": "",
                                "ExecutionPolicy": "Bypass",
                                "PackageID": null,
                                "Parameters": "",
                                "RunAsUser": false,
                                "ScriptName": null,
                                "WorkingDirectory": "X:\\",
                                "Enabled": true,
                                "OutputVariableName": "ChassisType",
                                "ContinueOnError": true,
                                "SupportedEnv": "WinPEandFullOS",
                                "SuccessCodes": "0 3010",
                                "Timeout": null
                              },
                              "2": {
                                "Name": "Set FastBoot to Auto",
                                "Type": "RunCommandLineAction",
                                "Action": "smsswd.exe /run:KOW00BA5 cctk.cmd --Fastboot=Auto",
                                "Description": "",
                                "Conditions": "",
                                "ExecutionPolicy": null,
                                "PackageID": "KOW00BA5",
                                "Parameters": null,
                                "RunAsUser": false,
                                "ScriptName": null,
                                "SourceScript": null,
                                "WorkingDirectory": null,
                                "Enabled": true,
                                "OutputVariableName": "",
                                "ContinueOnError": true,
                                "SupportedEnv": "WinPEandFullOS",
                                "SuccessCodes": "0 3010",
                                "Timeout": null
                              },
                              "3": {
                                "Name": "Set SATA-RAID Setting",
                                "Type": "RunCommandLineAction",
                                "Action": "smsswd.exe /run:KOW00BA5 cctk.cmd --embsataraid=Raid",
                                "Description": "",
                                "Conditions": "",
                                "ExecutionPolicy": null,
                                "PackageID": "KOW00BA5",
                                "Parameters": null,
                                "RunAsUser": false,
                                "ScriptName": null,
                                "SourceScript": null,
                                "WorkingDirectory": null,
                                "Enabled": true,
                                "OutputVariableName": "",
                                "ContinueOnError": true,
                                "SupportedEnv": "WinPEandFullOS",
                                "SuccessCodes": "0 3010",
                                "Timeout": null
                              },
                              "4": {
                                "Name": "Laptops",
                                "Type": "Group",
                                "Description": "",
                                "Condition": null,
                                "Enabled": true,
                                "ContinueOnError": false,
                                "Steps": {
                                  "1": {
                                    "Name": "Enable TbtPcieModeAutoSwitch",
                                    "Type": "RunCommandLineAction",
                                    "Action": "smsswd.exe /run:KOW00BA5 cctk.cmd --TbtPcieModeAutoSwitch=Enabled",
                                    "Description": "",
                                    "Conditions": "",
                                    "ExecutionPolicy": null,
                                    "PackageID": "KOW00BA5",
                                    "Parameters": null,
                                    "RunAsUser": false,
                                    "ScriptName": null,
                                    "SourceScript": null,
                                    "WorkingDirectory": null,
                                    "Enabled": true,
                                    "OutputVariableName": "",
                                    "ContinueOnError": true,
                                    "SupportedEnv": "WinPEandFullOS",
                                    "SuccessCodes": "0 3010",
                                    "Timeout": null
                                  },
                                  "2": {
                                    "Name": "Enable ThunderboltBoot",
                                    "Type": "RunCommandLineAction",
                                    "Action": "smsswd.exe /run:KOW00BA5 cctk.cmd --ThunderboltBoot=Enabled",
                                    "Description": "",
                                    "Conditions": "",
                                    "ExecutionPolicy": null,
                                    "PackageID": "KOW00BA5",
                                    "Parameters": null,
                                    "RunAsUser": false,
                                    "ScriptName": null,
                                    "SourceScript": null,
                                    "WorkingDirectory": null,
                                    "Enabled": true,
                                    "OutputVariableName": "",
                                    "ContinueOnError": true,
                                    "SupportedEnv": "WinPEandFullOS",
                                    "SuccessCodes": "0 3010",
                                    "Timeout": null
                                  },
                                  "3": {
                                    "Name": "Enable Thunderbolt",
                                    "Type": "RunCommandLineAction",
                                    "Action": "smsswd.exe /run:KOW00BA5 cctk.cmd --Thunderbolt=Enabled",
                                    "Description": "",
                                    "Conditions": "",
                                    "ExecutionPolicy": null,
                                    "PackageID": "KOW00BA5",
                                    "Parameters": null,
                                    "RunAsUser": false,
                                    "ScriptName": null,
                                    "SourceScript": null,
                                    "WorkingDirectory": null,
                                    "Enabled": true,
                                    "OutputVariableName": "",
                                    "ContinueOnError": true,
                                    "SupportedEnv": "WinPEandFullOS",
                                    "SuccessCodes": "0 3010",
                                    "Timeout": null
                                  },
                                  "4": {
                                    "Name": "Enable ThunderboltPreBoot",
                                    "Type": "RunCommandLineAction",
                                    "Action": "smsswd.exe /run:KOW00BA5 cctk.cmd --ThunderboltPreBoot=Enabled",
                                    "Description": "",
                                    "Conditions": "",
                                    "ExecutionPolicy": null,
                                    "PackageID": "KOW00BA5",
                                    "Parameters": null,
                                    "RunAsUser": false,
                                    "ScriptName": null,
                                    "SourceScript": null,
                                    "WorkingDirectory": null,
                                    "Enabled": true,
                                    "OutputVariableName": "",
                                    "ContinueOnError": true,
                                    "SupportedEnv": "WinPEandFullOS",
                                    "SuccessCodes": "0 3010",
                                    "Timeout": null
                                  },
                                  "5": {
                                    "Name": "Enable ThunderboltSecLvl",
                                    "Type": "RunCommandLineAction",
                                    "Action": "smsswd.exe /run:KOW00BA5 cctk.cmd --ThunderboltSecLvl=NoSec",
                                    "Description": "",
                                    "Conditions": "",
                                    "ExecutionPolicy": null,
                                    "PackageID": "KOW00BA5",
                                    "Parameters": null,
                                    "RunAsUser": false,
                                    "ScriptName": null,
                                    "SourceScript": null,
                                    "WorkingDirectory": null,
                                    "Enabled": true,
                                    "OutputVariableName": "",
                                    "ContinueOnError": true,
                                    "SupportedEnv": "WinPEandFullOS",
                                    "SuccessCodes": "0 3010",
                                    "Timeout": null
                                  },
                                  "6": {
                                    "Name": "Enable WirelessSwitchWlanCtrl",
                                    "Type": "RunCommandLineAction",
                                    "Action": "smsswd.exe /run:KOW00BA5 cctk.cmd --WirelessSwitchWlanCtrl=Enabled",
                                    "Description": "",
                                    "Conditions": "",
                                    "ExecutionPolicy": null,
                                    "PackageID": "KOW00BA5",
                                    "Parameters": null,
                                    "RunAsUser": false,
                                    "ScriptName": null,
                                    "SourceScript": null,
                                    "WorkingDirectory": null,
                                    "Enabled": true,
                                    "OutputVariableName": "",
                                    "ContinueOnError": true,
                                    "SupportedEnv": "WinPEandFullOS",
                                    "SuccessCodes": "0 3010",
                                    "Timeout": null
                                  }
                                }
                              },
                              "5": {
                                "Name": "Desktops",
                                "Type": "Group",
                                "Description": "",
                                "Condition": null,
                                "Enabled": true,
                                "ContinueOnError": false,
                                "Steps": null
                              },
                              "6": {
                                "Name": "Enable Wake On Lan",
                                "Type": "RunCommandLineAction",
                                "Action": "smsswd.exe /run:KOW00BA5 cctk.cmd --WakeOnLan=LanOnly",
                                "Description": "",
                                "Conditions": "",
                                "ExecutionPolicy": null,
                                "PackageID": "KOW00BA5",
                                "Parameters": null,
                                "RunAsUser": false,
                                "ScriptName": null,
                                "SourceScript": null,
                                "WorkingDirectory": null,
                                "Enabled": true,
                                "OutputVariableName": "",
                                "ContinueOnError": true,
                                "SupportedEnv": "WinPEandFullOS",
                                "SuccessCodes": "0 3010",
                                "Timeout": null
                              },
                              "7": {
                                "Name": "Enable WLAN AutoSense",
                                "Type": "RunCommandLineAction",
                                "Action": "smsswd.exe /run:KOW00BA5 cctk.cmd --WlanAutoSense=Enabled",
                                "Description": "",
                                "Conditions": "",
                                "ExecutionPolicy": null,
                                "PackageID": "KOW00BA5",
                                "Parameters": null,
                                "RunAsUser": false,
                                "ScriptName": null,
                                "SourceScript": null,
                                "WorkingDirectory": null,
                                "Enabled": true,
                                "OutputVariableName": "",
                                "ContinueOnError": true,
                                "SupportedEnv": "WinPEandFullOS",
                                "SuccessCodes": "0 3010",
                                "Timeout": null
                              }
                            }
                          },
                          "3": {
                            "Name": "Set Task Sequence Variables",
                            "Type": "Group",
                            "Description": "Actions to capture files and settings in the original operating system",
                            "Condition": null,
                            "Enabled": true,
                            "ContinueOnError": false,
                            "Steps": {
                              "1": {
                                "Name": "Set TS KOWBIOS Finish Time",
                                "Type": "RunCommandLineAction",
                                "Action": "smsswd.exe /run: %windir%\\System32\\WindowsPowerShell\\v1.0\\powershell.exe -command \"& {$tsenv = New-Object -COMObject Microsoft.SMS.TSEnvironment; $tsenv.Value('SMSTS_FinishTSTime_KOWBIOS') = Get-Date -Format 'dd.MM.yyyy HH:mm:ss'}\"",
                                "Description": "To be used later to determine how long the TS ran",
                                "Conditions": "",
                                "ExecutionPolicy": null,
                                "PackageID": null,
                                "Parameters": null,
                                "RunAsUser": false,
                                "ScriptName": null,
                                "SourceScript": null,
                                "WorkingDirectory": null,
                                "Enabled": true,
                                "OutputVariableName": "",
                                "ContinueOnError": true,
                                "SupportedEnv": "WinPEandFullOS",
                                "SuccessCodes": "0 3010",
                                "Timeout": null
                              },
                              "2": {
                                "Name": "Set TS KOWBIOS Duration",
                                "Type": "RunPowerShellScriptAction",
                                "Action": "OSDRunPowerShellScript.exe",
                                "Description": "",
                                "Conditions": "",
                                "ExecutionPolicy": "Bypass",
                                "PackageID": null,
                                "Parameters": "-DurationName \"KOWBIOS\"",
                                "RunAsUser": false,
                                "ScriptName": null,
                                "WorkingDirectory": null,
                                "Enabled": true,
                                "OutputVariableName": "",
                                "ContinueOnError": false,
                                "SupportedEnv": "WinPEandFullOS",
                                "SuccessCodes": "0 3010",
                                "Timeout": null
                              }
                            }
                          }
                        }
                      }
                    }
                  }
                }
              }
            },
            "3": {
              "Name": "02 OS Installation",
              "Type": "Group",
              "Description": "",
              "Condition": null,
              "Enabled": true,
              "ContinueOnError": false,
              "Steps": {
                "1": {
                  "Name": "Status 02 (OS Installation)",
                  "Type": "SetVariableAction",
                  "Action": "tsenv.exe \"TSBStatus=General,Status02\" /hiddenflag:False",
                  "Description": "",
                  "Conditions": "",
                  "ExecutionPolicy": null,
                  "PackageID": null,
                  "Parameters": null,
                  "RunAsUser": null,
                  "ScriptName": null,
                  "SourceScript": null,
                  "WorkingDirectory": null,
                  "Enabled": true,
                  "OutputVariableName": null,
                  "ContinueOnError": false,
                  "SupportedEnv": "WinPEandFullOS",
                  "SuccessCodes": null,
                  "Timeout": null
                },
                "2": {
                  "Name": "Module | KOW | OS Installation",
                  "Type": "SubTasksequence",
                  "Description": "OS- und Treiber-Installation",
                  "Condition": null,
                  "Enabled": true,
                  "SupportedEnv": "WinPEandFullOS",
                  "TSName": "KOW010FE, Module | KOW | OS Installation",
                  "TSPackageID": "KOW010FE",
                  "TSReferenceApplications": "",
                  "TSReferencePackages": "KOW00004,KOW00078,KOW00FA3,KOW00FFD,KOW01126,KOW01127,KOW0116E,KOW01303",
                  "TSReferenceSoftwareUpdates": "",
                  "ContinueOnError": false,
                  "SubTaskSequence": {
                    "1": {
                      "1": {
                        "Name": "OS Installation",
                        "Type": "Group",
                        "Description": "",
                        "Condition": null,
                        "Enabled": true,
                        "ContinueOnError": true,
                        "Steps": {
                          "1": {
                            "Name": "Set Task Sequence Variables",
                            "Type": "Group",
                            "Description": "Actions to capture files and settings in the original operating system",
                            "Condition": null,
                            "Enabled": true,
                            "ContinueOnError": false,
                            "Steps": {
                              "1": {
                                "Name": "Set TS KOWOS Start Time",
                                "Type": "RunCommandLineAction",
                                "Action": "smsswd.exe /run: %windir%\\System32\\WindowsPowerShell\\v1.0\\powershell.exe -command \"& {$tsenv = New-Object -COMObject Microsoft.SMS.TSEnvironment; $tsenv.Value('SMSTS_StartTSTime_KOWOS') = Get-Date -Format 'dd.MM.yyyy HH:mm:ss'}\"",
                                "Description": "To be used later to determine how long the TS ran",
                                "Conditions": "",
                                "ExecutionPolicy": null,
                                "PackageID": null,
                                "Parameters": null,
                                "RunAsUser": false,
                                "ScriptName": null,
                                "SourceScript": null,
                                "WorkingDirectory": null,
                                "Enabled": true,
                                "OutputVariableName": "",
                                "ContinueOnError": true,
                                "SupportedEnv": "WinPEandFullOS",
                                "SuccessCodes": "0 3010",
                                "Timeout": null
                              }
                            }
                          },
                          "2": {
                            "Name": "Status 02.01 (Deploy Image)",
                            "Type": "SetVariableAction",
                            "Action": "tsenv.exe \"TSBStatus=General,Status02,Sub0201\" /hiddenflag:False",
                            "Description": "",
                            "Conditions": "",
                            "ExecutionPolicy": null,
                            "PackageID": null,
                            "Parameters": null,
                            "RunAsUser": null,
                            "ScriptName": null,
                            "SourceScript": null,
                            "WorkingDirectory": null,
                            "Enabled": true,
                            "OutputVariableName": null,
                            "ContinueOnError": false,
                            "SupportedEnv": "WinPEandFullOS",
                            "SuccessCodes": null,
                            "Timeout": null
                          },
                          "3": {
                            "Name": "Choose Image Language",
                            "Type": "Group",
                            "Description": "",
                            "Condition": null,
                            "Enabled": true,
                            "ContinueOnError": false,
                            "Steps": {
                              "1": {
                                "Name": "Windows 10 Pro EN",
                                "Type": "ApplyOperatingSystemAction",
                                "Action": "OSDApplyOS.exe /image:KOW01127,%OSDImageIndex% \"/config:KOW00FFD,%OSDConfigFileName%\" /runfromnet:False",
                                "Description": "",
                                "Conditions": "--B--Task Sequence Variable:--/B----CRLF----TAB--KOSRegionSelected notEquals Austria",
                                "ExecutionPolicy": null,
                                "PackageID": null,
                                "Parameters": null,
                                "RunAsUser": null,
                                "ScriptName": null,
                                "SourceScript": null,
                                "WorkingDirectory": null,
                                "Enabled": true,
                                "OutputVariableName": null,
                                "ContinueOnError": false,
                                "SupportedEnv": "WinPE",
                                "SuccessCodes": null,
                                "Timeout": null
                              },
                              "2": {
                                "Name": "Windows 10 Pro DE",
                                "Type": "ApplyOperatingSystemAction",
                                "Action": "OSDApplyOS.exe /image:KOW01126,%OSDImageIndex% \"/config:KOW00FFD,%OSDConfigFileName%\" /runfromnet:False",
                                "Description": "",
                                "Conditions": "---I--If all of these conditions are true:--/I----CRLF----TAB----B--Task Sequence Variable:--/B----CRLF----TAB----TAB--KOSRegionSelected equals Austria--CRLF----TAB-----I--If any of these conditions are true:--/I----CRLF----TAB----TAB----B--Task Sequence Variable:--/B----CRLF----TAB----TAB----TAB--KOSWinVer notEquals Enterprise--CRLF----TAB----TAB----B--Task Sequence Variable:--/B----CRLF----TAB----TAB----TAB--KOSWinVer equals Professional--CRLF----TAB----TAB----B--Task Sequence Variable:--/B----CRLF----TAB----TAB----TAB--KOSWinVer notExists ",
                                "ExecutionPolicy": null,
                                "PackageID": null,
                                "Parameters": null,
                                "RunAsUser": null,
                                "ScriptName": null,
                                "SourceScript": null,
                                "WorkingDirectory": null,
                                "Enabled": true,
                                "OutputVariableName": null,
                                "ContinueOnError": false,
                                "SupportedEnv": "WinPE",
                                "SuccessCodes": null,
                                "Timeout": null
                              },
                              "3": {
                                "Name": "Windows 10 Ent DE",
                                "Type": "ApplyOperatingSystemAction",
                                "Action": "OSDApplyOS.exe /image:KOW01303,%OSDImageIndex% \"/config:KOW00FFD,%OSDConfigFileName%\" /runfromnet:False",
                                "Description": "",
                                "Conditions": "---I--If all of these conditions are true:--/I----CRLF----TAB----B--Task Sequence Variable:--/B----CRLF----TAB----TAB--KOSWinVer equals Enterprise--CRLF----TAB----B--Task Sequence Variable:--/B----CRLF----TAB----TAB--KOSRegionSelected equals Austria",
                                "ExecutionPolicy": null,
                                "PackageID": null,
                                "Parameters": null,
                                "RunAsUser": null,
                                "ScriptName": null,
                                "SourceScript": null,
                                "WorkingDirectory": null,
                                "Enabled": true,
                                "OutputVariableName": null,
                                "ContinueOnError": false,
                                "SupportedEnv": "WinPE",
                                "SuccessCodes": null,
                                "Timeout": null
                              }
                            }
                          },
                          "4": {
                            "Name": "Windows Configuration",
                            "Type": "Group",
                            "Description": "",
                            "Condition": null,
                            "Enabled": true,
                            "ContinueOnError": false,
                            "Steps": {
                              "1": {
                                "Name": "Region",
                                "Type": "Group",
                                "Description": "",
                                "Condition": null,
                                "Enabled": true,
                                "ContinueOnError": false,
                                "Steps": {
                                  "1": {
                                    "Name": "Default",
                                    "Type": "Group",
                                    "Description": "",
                                    "Condition": null,
                                    "Enabled": true,
                                    "ContinueOnError": false,
                                    "Steps": {
                                      "1": {
                                        "Name": "Default InputLocale",
                                        "Type": "SetVariableAction",
                                        "Action": "tsenv.exe \"OSDWindowsSettingsInputLocale=en-US\" /hiddenflag:False",
                                        "Description": "",
                                        "Conditions": "",
                                        "ExecutionPolicy": null,
                                        "PackageID": null,
                                        "Parameters": null,
                                        "RunAsUser": null,
                                        "ScriptName": null,
                                        "SourceScript": null,
                                        "WorkingDirectory": null,
                                        "Enabled": true,
                                        "OutputVariableName": null,
                                        "ContinueOnError": false,
                                        "SupportedEnv": "WinPEandFullOS",
                                        "SuccessCodes": null,
                                        "Timeout": null
                                      }
                                    }
                                  },
                                  "2": {
                                    "Name": "Austria",
                                    "Type": "Group",
                                    "Description": "",
                                    "Condition": null,
                                    "Enabled": true,
                                    "ContinueOnError": false,
                                    "Steps": {
                                      "1": {
                                        "Name": "AT InputLocale",
                                        "Type": "SetVariableAction",
                                        "Action": "tsenv.exe \"OSDWindowsSettingsInputLocale=de-AT;0c07:00000407;en-US;0409:00000409\" /hiddenflag:False",
                                        "Description": "",
                                        "Conditions": "",
                                        "ExecutionPolicy": null,
                                        "PackageID": null,
                                        "Parameters": null,
                                        "RunAsUser": null,
                                        "ScriptName": null,
                                        "SourceScript": null,
                                        "WorkingDirectory": null,
                                        "Enabled": true,
                                        "OutputVariableName": null,
                                        "ContinueOnError": false,
                                        "SupportedEnv": "WinPEandFullOS",
                                        "SuccessCodes": null,
                                        "Timeout": null
                                      },
                                      "2": {
                                        "Name": "Apply Windows Settings - Austria",
                                        "Type": "ApplyWindowsSettingsAction",
                                        "Action": "osdwinsettings.exe /config",
                                        "Description": "Actions to apply Windows settings",
                                        "Conditions": "",
                                        "ExecutionPolicy": null,
                                        "PackageID": null,
                                        "Parameters": null,
                                        "RunAsUser": null,
                                        "ScriptName": null,
                                        "SourceScript": null,
                                        "WorkingDirectory": null,
                                        "Enabled": true,
                                        "OutputVariableName": null,
                                        "ContinueOnError": false,
                                        "SupportedEnv": "WinPE",
                                        "SuccessCodes": null,
                                        "Timeout": null
                                      }
                                    }
                                  },
                                  "3": {
                                    "Name": "Croatia",
                                    "Type": "Group",
                                    "Description": "",
                                    "Condition": null,
                                    "Enabled": true,
                                    "ContinueOnError": false,
                                    "Steps": {
                                      "1": {
                                        "Name": "HR InputLocale",
                                        "Type": "SetVariableAction",
                                        "Action": "tsenv.exe \"OSDWindowsSettingsInputLocale=hr-HR;041a:0000041a;en-US;0409:00000409\" /hiddenflag:False",
                                        "Description": "",
                                        "Conditions": "",
                                        "ExecutionPolicy": null,
                                        "PackageID": null,
                                        "Parameters": null,
                                        "RunAsUser": null,
                                        "ScriptName": null,
                                        "SourceScript": null,
                                        "WorkingDirectory": null,
                                        "Enabled": true,
                                        "OutputVariableName": null,
                                        "ContinueOnError": false,
                                        "SupportedEnv": "WinPEandFullOS",
                                        "SuccessCodes": null,
                                        "Timeout": null
                                      },
                                      "2": {
                                        "Name": "Apply Windows Settings - Croatia",
                                        "Type": "ApplyWindowsSettingsAction",
                                        "Action": "osdwinsettings.exe /config",
                                        "Description": "Actions to apply Windows settings",
                                        "Conditions": "",
                                        "ExecutionPolicy": null,
                                        "PackageID": null,
                                        "Parameters": null,
                                        "RunAsUser": null,
                                        "ScriptName": null,
                                        "SourceScript": null,
                                        "WorkingDirectory": null,
                                        "Enabled": true,
                                        "OutputVariableName": null,
                                        "ContinueOnError": false,
                                        "SupportedEnv": "WinPE",
                                        "SuccessCodes": null,
                                        "Timeout": null
                                      }
                                    }
                                  },
                                  "4": {
                                    "Name": "India",
                                    "Type": "Group",
                                    "Description": "",
                                    "Condition": null,
                                    "Enabled": true,
                                    "ContinueOnError": false,
                                    "Steps": {
                                      "1": {
                                        "Name": "Apply Windows Settings - India",
                                        "Type": "ApplyWindowsSettingsAction",
                                        "Action": "osdwinsettings.exe /config",
                                        "Description": "Actions to apply Windows settings",
                                        "Conditions": "",
                                        "ExecutionPolicy": null,
                                        "PackageID": null,
                                        "Parameters": null,
                                        "RunAsUser": null,
                                        "ScriptName": null,
                                        "SourceScript": null,
                                        "WorkingDirectory": null,
                                        "Enabled": true,
                                        "OutputVariableName": null,
                                        "ContinueOnError": false,
                                        "SupportedEnv": "WinPE",
                                        "SuccessCodes": null,
                                        "Timeout": null
                                      }
                                    }
                                  },
                                  "5": {
                                    "Name": "USA",
                                    "Type": "Group",
                                    "Description": "",
                                    "Condition": null,
                                    "Enabled": true,
                                    "ContinueOnError": false,
                                    "Steps": {
                                      "1": {
                                        "Name": "Apply Windows Settings - USA",
                                        "Type": "ApplyWindowsSettingsAction",
                                        "Action": "osdwinsettings.exe /config",
                                        "Description": "Actions to apply Windows settings",
                                        "Conditions": "",
                                        "ExecutionPolicy": null,
                                        "PackageID": null,
                                        "Parameters": null,
                                        "RunAsUser": null,
                                        "ScriptName": null,
                                        "SourceScript": null,
                                        "WorkingDirectory": null,
                                        "Enabled": true,
                                        "OutputVariableName": null,
                                        "ContinueOnError": false,
                                        "SupportedEnv": "WinPE",
                                        "SuccessCodes": null,
                                        "Timeout": null
                                      }
                                    }
                                  }
                                }
                              },
                              "2": {
                                "Name": "Apply Network Settings (Rollout)",
                                "Type": "ApplyNetworkSettingsAction",
                                "Action": "osdnetsettings.exe configure",
                                "Description": "Actions to configure network settings",
                                "Conditions": "",
                                "ExecutionPolicy": null,
                                "PackageID": null,
                                "Parameters": null,
                                "RunAsUser": null,
                                "ScriptName": null,
                                "SourceScript": null,
                                "WorkingDirectory": null,
                                "Enabled": true,
                                "OutputVariableName": null,
                                "ContinueOnError": false,
                                "SupportedEnv": "WinPE",
                                "SuccessCodes": null,
                                "Timeout": null
                              }
                            }
                          },
                          "5": {
                            "Name": "Install Drivers",
                            "Type": "Group",
                            "Description": "",
                            "Condition": null,
                            "Enabled": true,
                            "ContinueOnError": false,
                            "Steps": {
                              "1": {
                                "Name": "Status 02.02 (Install Drivers)",
                                "Type": "SetVariableAction",
                                "Action": "tsenv.exe \"TSBStatus=General,Status02,Sub0202\" /hiddenflag:False",
                                "Description": "",
                                "Conditions": "",
                                "ExecutionPolicy": null,
                                "PackageID": null,
                                "Parameters": null,
                                "RunAsUser": null,
                                "ScriptName": null,
                                "SourceScript": null,
                                "WorkingDirectory": null,
                                "Enabled": true,
                                "OutputVariableName": null,
                                "ContinueOnError": false,
                                "SupportedEnv": "WinPEandFullOS",
                                "SuccessCodes": null,
                                "Timeout": null
                              },
                              "2": {
                                "Name": "Module | KOW | BIOS Variables",
                                "Type": "SubTasksequence",
                                "Description": "Auslesen der benÃ¶tigten Pakete welche zur Installation bei diesem Model notwendig sind. (BIOS und Treiber)",
                                "Condition": null,
                                "Enabled": true,
                                "SupportedEnv": "WinPEandFullOS",
                                "TSName": "KOW0116E, Module | KOW | BIOS Variables",
                                "TSPackageID": "KOW0116E",
                                "TSReferenceApplications": "",
                                "TSReferencePackages": "",
                                "TSReferenceSoftwareUpdates": "",
                                "ContinueOnError": false,
                                "SubTaskSequence": {
                                  "1": {
                                    "1": {
                                      "Name": "BIOS Variables",
                                      "Type": "Group",
                                      "Description": "",
                                      "Condition": null,
                                      "Enabled": true,
                                      "ContinueOnError": false,
                                      "Steps": {
                                        "1": {
                                          "Name": "Set FLASHBIOSCMD UEFI",
                                          "Type": "SetDynamicVariablesAction",
                                          "Action": "OSDSetDynamicVariables.exe",
                                          "Description": "This FLASHBIOSCMD will get updated if a BIOSPW is set and PWMATCH is true in the BIOS PW Module",
                                          "Conditions": "--B--Task Sequence Variable:--/B----CRLF----TAB--_SMSTSBootUEFI equals TRUE",
                                          "ExecutionPolicy": null,
                                          "PackageID": null,
                                          "Parameters": null,
                                          "RunAsUser": null,
                                          "ScriptName": null,
                                          "SourceScript": null,
                                          "WorkingDirectory": null,
                                          "Enabled": true,
                                          "OutputVariableName": null,
                                          "ContinueOnError": false,
                                          "SupportedEnv": "WinPEandFullOS",
                                          "SuccessCodes": null,
                                          "Timeout": null
                                        },
                                        "2": {
                                          "Name": "Set FLASHBIOSCMD LEGACY",
                                          "Type": "SetDynamicVariablesAction",
                                          "Action": "OSDSetDynamicVariables.exe",
                                          "Description": "This FLASHBIOSCMD will get updated if a BIOSPW is set and PWMATCH is true in the BIOS PW Module",
                                          "Conditions": "--B--Task Sequence Variable:--/B----CRLF----TAB--_SMSTSBootUEFI notEquals TRUE",
                                          "ExecutionPolicy": null,
                                          "PackageID": null,
                                          "Parameters": null,
                                          "RunAsUser": null,
                                          "ScriptName": null,
                                          "SourceScript": null,
                                          "WorkingDirectory": null,
                                          "Enabled": true,
                                          "OutputVariableName": null,
                                          "ContinueOnError": false,
                                          "SupportedEnv": "WinPEandFullOS",
                                          "SuccessCodes": null,
                                          "Timeout": null
                                        },
                                        "3": {
                                          "Name": "Dell",
                                          "Type": "Group",
                                          "Description": "",
                                          "Condition": null,
                                          "Enabled": true,
                                          "ContinueOnError": false,
                                          "Steps": {
                                            "1": {
                                              "Name": "Set Dell BIOS Package Variables - Prod",
                                              "Type": "SetDynamicVariablesAction",
                                              "Action": "OSDSetDynamicVariables.exe",
                                              "Description": "This Step maps the model to the BIOS packages required.",
                                              "Conditions": "--B--WMI Query:--/B----CRLF----TAB--Select * From Win32_ComputerSystem WHERE Manufacturer LIKE \"%DELL%\"--CRLF----B--Task Sequence Variable:--/B----CRLF----TAB--PREPROD_BIOS notEquals TRUE",
                                              "ExecutionPolicy": null,
                                              "PackageID": null,
                                              "Parameters": null,
                                              "RunAsUser": null,
                                              "ScriptName": null,
                                              "SourceScript": null,
                                              "WorkingDirectory": null,
                                              "Enabled": true,
                                              "OutputVariableName": null,
                                              "ContinueOnError": false,
                                              "SupportedEnv": "WinPEandFullOS",
                                              "SuccessCodes": null,
                                              "Timeout": null
                                            },
                                            "2": {
                                              "Name": "Set Dell Driver Package Variables - Prod",
                                              "Type": "SetDynamicVariablesAction",
                                              "Action": "OSDSetDynamicVariables.exe",
                                              "Description": "This Step maps the model to the BIOS packages required.",
                                              "Conditions": "--B--WMI Query:--/B----CRLF----TAB--Select * From Win32_ComputerSystem WHERE Manufacturer LIKE \"%DELL%\"--CRLF----B--Task Sequence Variable:--/B----CRLF----TAB--PREPROD_DRIVER notEquals TRUE",
                                              "ExecutionPolicy": null,
                                              "PackageID": null,
                                              "Parameters": null,
                                              "RunAsUser": null,
                                              "ScriptName": null,
                                              "SourceScript": null,
                                              "WorkingDirectory": null,
                                              "Enabled": true,
                                              "OutputVariableName": null,
                                              "ContinueOnError": false,
                                              "SupportedEnv": "WinPEandFullOS",
                                              "SuccessCodes": null,
                                              "Timeout": null
                                            },
                                            "3": {
                                              "Name": "Set Dell BIOS Package Variables - Pre-Prod",
                                              "Type": "SetDynamicVariablesAction",
                                              "Action": "OSDSetDynamicVariables.exe",
                                              "Description": "This Step maps the model to the BIOS packages required.",
                                              "Conditions": "--B--WMI Query:--/B----CRLF----TAB--Select * From Win32_ComputerSystem WHERE Manufacturer LIKE \"%DELL%\"--CRLF----B--Task Sequence Variable:--/B----CRLF----TAB--PREPROD_BIOS equals TRUE",
                                              "ExecutionPolicy": null,
                                              "PackageID": null,
                                              "Parameters": null,
                                              "RunAsUser": null,
                                              "ScriptName": null,
                                              "SourceScript": null,
                                              "WorkingDirectory": null,
                                              "Enabled": true,
                                              "OutputVariableName": null,
                                              "ContinueOnError": false,
                                              "SupportedEnv": "WinPEandFullOS",
                                              "SuccessCodes": null,
                                              "Timeout": null
                                            },
                                            "4": {
                                              "Name": "Set Dell Driver Package Variables - Pre-Prod",
                                              "Type": "SetDynamicVariablesAction",
                                              "Action": "OSDSetDynamicVariables.exe",
                                              "Description": "This Step maps the model to the BIOS packages required.",
                                              "Conditions": "--B--WMI Query:--/B----CRLF----TAB--Select * From Win32_ComputerSystem WHERE Manufacturer LIKE \"%DELL%\"--CRLF----B--Task Sequence Variable:--/B----CRLF----TAB--PREPROD_DRIVER equals TRUE",
                                              "ExecutionPolicy": null,
                                              "PackageID": null,
                                              "Parameters": null,
                                              "RunAsUser": null,
                                              "ScriptName": null,
                                              "SourceScript": null,
                                              "WorkingDirectory": null,
                                              "Enabled": true,
                                              "OutputVariableName": null,
                                              "ContinueOnError": false,
                                              "SupportedEnv": "WinPEandFullOS",
                                              "SuccessCodes": null,
                                              "Timeout": null
                                            }
                                          }
                                        },
                                        "4": {
                                          "Name": "HP",
                                          "Type": "Group",
                                          "Description": "",
                                          "Condition": null,
                                          "Enabled": true,
                                          "ContinueOnError": false,
                                          "Steps": {
                                            "1": {
                                              "Name": "Set HP BIOS Package Variables - Prod",
                                              "Type": "SetDynamicVariablesAction",
                                              "Action": "OSDSetDynamicVariables.exe",
                                              "Description": "This Step maps the model to the BIOS packages required.",
                                              "Conditions": "--B--Task Sequence Variable:--/B----CRLF----TAB--PREPROD_BIOS notEquals TRUE--CRLF-----I--If any of these conditions are true:--/I----CRLF----TAB----B--WMI Query:--/B----CRLF----TAB----TAB--Select * From Win32_ComputerSystem WHERE Manufacturer LIKE \"%HP%\"--CRLF----TAB----B--WMI Query:--/B----CRLF----TAB----TAB--Select * From Win32_ComputerSystem WHERE Manufacturer LIKE \"%Hewlett-Packard%\"",
                                              "ExecutionPolicy": null,
                                              "PackageID": null,
                                              "Parameters": null,
                                              "RunAsUser": null,
                                              "ScriptName": null,
                                              "SourceScript": null,
                                              "WorkingDirectory": null,
                                              "Enabled": true,
                                              "OutputVariableName": null,
                                              "ContinueOnError": false,
                                              "SupportedEnv": "WinPEandFullOS",
                                              "SuccessCodes": null,
                                              "Timeout": null
                                            },
                                            "2": {
                                              "Name": "Set HP BIOS Package Variables - Pre-Prod",
                                              "Type": "SetDynamicVariablesAction",
                                              "Action": "OSDSetDynamicVariables.exe",
                                              "Description": "This Step maps the model to the BIOS packages required.",
                                              "Conditions": "--B--Task Sequence Variable:--/B----CRLF----TAB--PREPROD_BIOS equals TRUE--CRLF-----I--If any of these conditions are true:--/I----CRLF----TAB----B--WMI Query:--/B----CRLF----TAB----TAB--Select * From Win32_ComputerSystem WHERE Manufacturer LIKE \"%HP%\"--CRLF----TAB----B--WMI Query:--/B----CRLF----TAB----TAB--Select * From Win32_ComputerSystem WHERE Manufacturer LIKE \"%Hewlett-Packard%\"",
                                              "ExecutionPolicy": null,
                                              "PackageID": null,
                                              "Parameters": null,
                                              "RunAsUser": null,
                                              "ScriptName": null,
                                              "SourceScript": null,
                                              "WorkingDirectory": null,
                                              "Enabled": true,
                                              "OutputVariableName": null,
                                              "ContinueOnError": false,
                                              "SupportedEnv": "WinPEandFullOS",
                                              "SuccessCodes": null,
                                              "Timeout": null
                                            }
                                          }
                                        }
                                      }
                                    }
                                  }
                                }
                              },
                              "3": {
                                "Name": "PreProd | KOW | Module | Dell Treiberinstall",
                                "Type": "SubTasksequence",
                                "Description": "Installation der Treiber Ã¼ber WMI Pakete",
                                "Condition": null,
                                "Enabled": true,
                                "SupportedEnv": "WinPEandFullOS",
                                "TSName": "KOW00FA3, PreProd | KOW | Module | Dell Treiberinstall",
                                "TSPackageID": "KOW00FA3",
                                "TSReferenceApplications": "",
                                "TSReferencePackages": "KOW00078",
                                "TSReferenceSoftwareUpdates": "",
                                "ContinueOnError": false,
                                "SubTaskSequence": {
                                  "1": {
                                    "1": {
                                      "Name": "Modern Driver Managment",
                                      "Type": "Group",
                                      "Description": "",
                                      "Condition": null,
                                      "Enabled": true,
                                      "ContinueOnError": false,
                                      "Steps": {
                                        "1": {
                                          "Name": "VMWare",
                                          "Type": "Group",
                                          "Description": "",
                                          "Condition": null,
                                          "Enabled": true,
                                          "ContinueOnError": false,
                                          "Steps": {
                                            "1": {
                                              "Name": "Apply Driver Package Vmware ESXi 6.7",
                                              "Type": "ApplyDriverPackageAction",
                                              "Action": "osddriverclient.exe /install:KOW00078  /unsigned:%OSDAllowUnsignedDriver% /recurse:%OSDRecurse%",
                                              "Description": "",
                                              "Conditions": "--B--WMI Query:--/B----CRLF----TAB--Select * from Win32_ComputerSystem where Model like  \"%VMware%\"",
                                              "ExecutionPolicy": null,
                                              "PackageID": null,
                                              "Parameters": null,
                                              "RunAsUser": null,
                                              "ScriptName": null,
                                              "SourceScript": null,
                                              "WorkingDirectory": null,
                                              "Enabled": true,
                                              "OutputVariableName": null,
                                              "ContinueOnError": false,
                                              "SupportedEnv": "WinPE",
                                              "SuccessCodes": null,
                                              "Timeout": null
                                            }
                                          }
                                        },
                                        "2": {
                                          "Name": "Dell",
                                          "Type": "Group",
                                          "Description": "",
                                          "Condition": null,
                                          "Enabled": true,
                                          "ContinueOnError": false,
                                          "Steps": {
                                            "1": {
                                              "Name": "Driver Mgmt with WIM",
                                              "Type": "Group",
                                              "Description": "",
                                              "Condition": null,
                                              "Enabled": true,
                                              "ContinueOnError": false,
                                              "Steps": {
                                                "1": {
                                                  "Name": "Create Drivers Directory",
                                                  "Type": "RunCommandLineAction",
                                                  "Action": "smsswd.exe /run: cmd.exe /c md %_SMSTSMDataPath%\\Drivers",
                                                  "Description": "",
                                                  "Conditions": "",
                                                  "ExecutionPolicy": null,
                                                  "PackageID": null,
                                                  "Parameters": null,
                                                  "RunAsUser": false,
                                                  "ScriptName": null,
                                                  "SourceScript": null,
                                                  "WorkingDirectory": null,
                                                  "Enabled": true,
                                                  "OutputVariableName": "",
                                                  "ContinueOnError": false,
                                                  "SupportedEnv": "WinPEandFullOS",
                                                  "SuccessCodes": "0 3010",
                                                  "Timeout": null
                                                },
                                                "2": {
                                                  "Name": "Download Driver Package",
                                                  "Type": "Group",
                                                  "Description": "",
                                                  "Condition": null,
                                                  "Enabled": true,
                                                  "ContinueOnError": false,
                                                  "Steps": {
                                                    "1": {
                                                      "Name": "Full OS",
                                                      "Type": "Group",
                                                      "Description": "",
                                                      "Condition": null,
                                                      "Enabled": true,
                                                      "ContinueOnError": false,
                                                      "Steps": {
                                                        "1": {
                                                          "Name": "Set Driver Download Variable",
                                                          "Type": "SetVariableAction",
                                                          "Action": "tsenv.exe \"PRECACHE001=%W10X64DRIVERPACKAGE%:Pre-cache\" /hiddenflag:False",
                                                          "Description": "",
                                                          "Conditions": "",
                                                          "ExecutionPolicy": null,
                                                          "PackageID": null,
                                                          "Parameters": null,
                                                          "RunAsUser": null,
                                                          "ScriptName": null,
                                                          "SourceScript": null,
                                                          "WorkingDirectory": null,
                                                          "Enabled": true,
                                                          "OutputVariableName": null,
                                                          "ContinueOnError": false,
                                                          "SupportedEnv": "WinPEandFullOS",
                                                          "SuccessCodes": null,
                                                          "Timeout": null
                                                        },
                                                        "2": {
                                                          "Name": "Downloading Driver Package %W10X64DRIVERPACKAGE%",
                                                          "Type": "InstallSoftwareAction",
                                                          "Action": "smsswd.exe /pkg: /install /basevar:PRECACHE /continueOnError:False",
                                                          "Description": "",
                                                          "Conditions": "",
                                                          "ExecutionPolicy": null,
                                                          "PackageID": null,
                                                          "Parameters": null,
                                                          "RunAsUser": null,
                                                          "ScriptName": null,
                                                          "SourceScript": null,
                                                          "WorkingDirectory": null,
                                                          "Enabled": true,
                                                          "OutputVariableName": null,
                                                          "ContinueOnError": false,
                                                          "SupportedEnv": "FullOS",
                                                          "SuccessCodes": null,
                                                          "Timeout": null
                                                        },
                                                        "3": {
                                                          "Name": "Set Drivers Path Variable",
                                                          "Type": "RunPowerShellScriptAction",
                                                          "Action": "OSDRunPowerShellScript.exe",
                                                          "Description": "",
                                                          "Conditions": "",
                                                          "ExecutionPolicy": "Bypass",
                                                          "PackageID": null,
                                                          "Parameters": "",
                                                          "RunAsUser": false,
                                                          "ScriptName": null,
                                                          "WorkingDirectory": "",
                                                          "Enabled": true,
                                                          "OutputVariableName": "",
                                                          "ContinueOnError": false,
                                                          "SupportedEnv": "WinPEandFullOS",
                                                          "SuccessCodes": "0",
                                                          "Timeout": null
                                                        }
                                                      }
                                                    },
                                                    "2": {
                                                      "Name": "WinPE",
                                                      "Type": "Group",
                                                      "Description": "Can't download Package in WinPE, so have to use this alternate method",
                                                      "Condition": null,
                                                      "Enabled": true,
                                                      "ContinueOnError": false,
                                                      "Steps": {
                                                        "1": {
                                                          "Name": "Set Driver Download Variables",
                                                          "Type": "SetDynamicVariablesAction",
                                                          "Action": "OSDSetDynamicVariables.exe",
                                                          "Description": "",
                                                          "Conditions": "",
                                                          "ExecutionPolicy": null,
                                                          "PackageID": null,
                                                          "Parameters": null,
                                                          "RunAsUser": null,
                                                          "ScriptName": null,
                                                          "SourceScript": null,
                                                          "WorkingDirectory": null,
                                                          "Enabled": true,
                                                          "OutputVariableName": null,
                                                          "ContinueOnError": false,
                                                          "SupportedEnv": "WinPEandFullOS",
                                                          "SuccessCodes": null,
                                                          "Timeout": null
                                                        },
                                                        "2": {
                                                          "Name": "Downloading Driver Package %W10X64DRIVERPACKAGE%",
                                                          "Type": "RunCommandLineAction",
                                                          "Action": "smsswd.exe /pkg: /install /basevar:PRECACHE /continueOnError:False",
                                                          "Description": "",
                                                          "Conditions": "",
                                                          "ExecutionPolicy": null,
                                                          "PackageID": null,
                                                          "Parameters": null,
                                                          "RunAsUser": false,
                                                          "ScriptName": null,
                                                          "SourceScript": null,
                                                          "WorkingDirectory": null,
                                                          "Enabled": true,
                                                          "OutputVariableName": "",
                                                          "ContinueOnError": false,
                                                          "SupportedEnv": "WinPEandFullOS",
                                                          "SuccessCodes": "0 3010",
                                                          "Timeout": null
                                                        },
                                                        "3": {
                                                          "Name": "Reset Download Variables",
                                                          "Type": "SetDynamicVariablesAction",
                                                          "Action": "OSDSetDynamicVariables.exe",
                                                          "Description": "",
                                                          "Conditions": "",
                                                          "ExecutionPolicy": null,
                                                          "PackageID": null,
                                                          "Parameters": null,
                                                          "RunAsUser": null,
                                                          "ScriptName": null,
                                                          "SourceScript": null,
                                                          "WorkingDirectory": null,
                                                          "Enabled": true,
                                                          "OutputVariableName": null,
                                                          "ContinueOnError": false,
                                                          "SupportedEnv": "WinPEandFullOS",
                                                          "SuccessCodes": null,
                                                          "Timeout": null
                                                        }
                                                      }
                                                    }
                                                  }
                                                },
                                                "3": {
                                                  "Name": "Install Driver Package",
                                                  "Type": "Group",
                                                  "Description": "",
                                                  "Condition": null,
                                                  "Enabled": true,
                                                  "ContinueOnError": false,
                                                  "Steps": {
                                                    "1": {
                                                      "Name": "Script: Get WIM Location and Name",
                                                      "Type": "RunPowerShellScriptAction",
                                                      "Action": "OSDRunPowerShellScript.exe",
                                                      "Description": "",
                                                      "Conditions": "",
                                                      "ExecutionPolicy": "Bypass",
                                                      "PackageID": null,
                                                      "Parameters": "",
                                                      "RunAsUser": false,
                                                      "ScriptName": null,
                                                      "WorkingDirectory": "",
                                                      "Enabled": true,
                                                      "OutputVariableName": "",
                                                      "ContinueOnError": false,
                                                      "SupportedEnv": "WinPEandFullOS",
                                                      "SuccessCodes": "0 3010",
                                                      "Timeout": null
                                                    },
                                                    "2": {
                                                      "Name": "Bash: Mount Drivers WIM",
                                                      "Type": "RunCommandLineAction",
                                                      "Action": "smsswd.exe /run: dism.exe /mount-wim /wimfile:%drivers01%\\%wimfile% /index:1 /mountdir:%_SMSTSMDatapath%\\Drivers",
                                                      "Description": "",
                                                      "Conditions": "",
                                                      "ExecutionPolicy": null,
                                                      "PackageID": null,
                                                      "Parameters": null,
                                                      "RunAsUser": false,
                                                      "ScriptName": null,
                                                      "SourceScript": null,
                                                      "WorkingDirectory": null,
                                                      "Enabled": true,
                                                      "OutputVariableName": "",
                                                      "ContinueOnError": false,
                                                      "SupportedEnv": "WinPEandFullOS",
                                                      "SuccessCodes": "0 3010",
                                                      "Timeout": null
                                                    },
                                                    "3": {
                                                      "Name": "Bash: Install Drivers via dism",
                                                      "Type": "RunCommandLineAction",
                                                      "Action": "smsswd.exe /run: dism.exe /Image:%OSDTargetSystemDrive%\\ /Add-Driver /Driver:%_SMSTSMDatapath%\\Drivers /Recurse /forceunsigned /logpath:%_SMSTSLogPath%\\dism.log",
                                                      "Description": "",
                                                      "Conditions": "",
                                                      "ExecutionPolicy": null,
                                                      "PackageID": null,
                                                      "Parameters": null,
                                                      "RunAsUser": false,
                                                      "ScriptName": null,
                                                      "SourceScript": null,
                                                      "WorkingDirectory": null,
                                                      "Enabled": true,
                                                      "OutputVariableName": "",
                                                      "ContinueOnError": false,
                                                      "SupportedEnv": "WinPEandFullOS",
                                                      "SuccessCodes": "0 3010",
                                                      "Timeout": null
                                                    },
                                                    "4": {
                                                      "Name": "Bash: Unmount Drivers WIM",
                                                      "Type": "RunCommandLineAction",
                                                      "Action": "smsswd.exe /run: dism.exe /unmount-wim /mountdir:%_SMSTSMDataPath%\\Drivers /discard",
                                                      "Description": "",
                                                      "Conditions": "",
                                                      "ExecutionPolicy": null,
                                                      "PackageID": null,
                                                      "Parameters": null,
                                                      "RunAsUser": false,
                                                      "ScriptName": null,
                                                      "SourceScript": null,
                                                      "WorkingDirectory": null,
                                                      "Enabled": true,
                                                      "OutputVariableName": "",
                                                      "ContinueOnError": false,
                                                      "SupportedEnv": "WinPEandFullOS",
                                                      "SuccessCodes": "0 3010",
                                                      "Timeout": null
                                                    }
                                                  }
                                                },
                                                "4": {
                                                  "Name": "Pause",
                                                  "Type": "RunCommandLineAction",
                                                  "Action": "smsswd.exe /run: cmd.exe /c \"start /wait cmd.exe\"",
                                                  "Description": "",
                                                  "Conditions": "--B--Task Sequence Variable:--/B----CRLF----TAB--PAUSE equals True",
                                                  "ExecutionPolicy": null,
                                                  "PackageID": null,
                                                  "Parameters": null,
                                                  "RunAsUser": false,
                                                  "ScriptName": null,
                                                  "SourceScript": null,
                                                  "WorkingDirectory": null,
                                                  "Enabled": true,
                                                  "OutputVariableName": "",
                                                  "ContinueOnError": false,
                                                  "SupportedEnv": "WinPEandFullOS",
                                                  "SuccessCodes": "0 3010",
                                                  "Timeout": null
                                                }
                                              }
                                            }
                                          }
                                        }
                                      }
                                    }
                                  }
                                }
                              },
                              "4": {
                                "Name": "Pause",
                                "Type": "RunCommandLineAction",
                                "Action": "smsswd.exe /run: cmd.exe /c \"start /wait cmd.exe\"",
                                "Description": "",
                                "Conditions": "--B--Task Sequence Variable:--/B----CRLF----TAB--PAUSE equals True",
                                "ExecutionPolicy": null,
                                "PackageID": null,
                                "Parameters": null,
                                "RunAsUser": false,
                                "ScriptName": null,
                                "SourceScript": null,
                                "WorkingDirectory": null,
                                "Enabled": true,
                                "OutputVariableName": "",
                                "ContinueOnError": false,
                                "SupportedEnv": "WinPEandFullOS",
                                "SuccessCodes": "0 3010",
                                "Timeout": null
                              }
                            }
                          },
                          "6": {
                            "Name": "Windows Customization",
                            "Type": "Group",
                            "Description": "",
                            "Condition": null,
                            "Enabled": true,
                            "ContinueOnError": true,
                            "Steps": {
                              "1": {
                                "Name": "Status 02.04 (Windows Customization)",
                                "Type": "SetVariableAction",
                                "Action": "tsenv.exe \"TSBStatus=General,Status02,Sub0204\" /hiddenflag:False",
                                "Description": "",
                                "Conditions": "",
                                "ExecutionPolicy": null,
                                "PackageID": null,
                                "Parameters": null,
                                "RunAsUser": null,
                                "ScriptName": null,
                                "SourceScript": null,
                                "WorkingDirectory": null,
                                "Enabled": true,
                                "OutputVariableName": null,
                                "ContinueOnError": false,
                                "SupportedEnv": "WinPEandFullOS",
                                "SuccessCodes": null,
                                "Timeout": null
                              },
                              "2": {
                                "Name": "Correct Missing Mouse Cursor",
                                "Type": "Group",
                                "Description": "",
                                "Condition": null,
                                "Enabled": true,
                                "ContinueOnError": true,
                                "Steps": {
                                  "1": {
                                    "Name": "Load Registry SOFTWARE Hive",
                                    "Type": "RunCommandLineAction",
                                    "Action": "smsswd.exe /run: reg.exe load HKLM\\Temp %OSDTargetSystemDrive%\\Windows\\system32\\config\\software",
                                    "Description": "",
                                    "Conditions": "",
                                    "ExecutionPolicy": null,
                                    "PackageID": null,
                                    "Parameters": null,
                                    "RunAsUser": false,
                                    "ScriptName": null,
                                    "SourceScript": null,
                                    "WorkingDirectory": null,
                                    "Enabled": true,
                                    "OutputVariableName": "",
                                    "ContinueOnError": true,
                                    "SupportedEnv": "WinPEandFullOS",
                                    "SuccessCodes": "0 3010",
                                    "Timeout": null
                                  },
                                  "2": {
                                    "Name": "Disable Suppressed Mouse Cursor",
                                    "Type": "RunCommandLineAction",
                                    "Action": "smsswd.exe /run: reg.exe add \"HKLM\\Temp\\Microsoft\\Windows\\CurrentVersion\\Policies\\System\" /v EnableCursorSuppression /t REG_DWORD /d 0 /f",
                                    "Description": "",
                                    "Conditions": "",
                                    "ExecutionPolicy": null,
                                    "PackageID": null,
                                    "Parameters": null,
                                    "RunAsUser": false,
                                    "ScriptName": null,
                                    "SourceScript": null,
                                    "WorkingDirectory": null,
                                    "Enabled": true,
                                    "OutputVariableName": "",
                                    "ContinueOnError": true,
                                    "SupportedEnv": "WinPEandFullOS",
                                    "SuccessCodes": "0 3010",
                                    "Timeout": null
                                  },
                                  "3": {
                                    "Name": "Unmount Registry SOFTWARE Hive",
                                    "Type": "RunCommandLineAction",
                                    "Action": "smsswd.exe /run: reg.exe unload HKLM\\Temp",
                                    "Description": "",
                                    "Conditions": "",
                                    "ExecutionPolicy": null,
                                    "PackageID": null,
                                    "Parameters": null,
                                    "RunAsUser": false,
                                    "ScriptName": null,
                                    "SourceScript": null,
                                    "WorkingDirectory": null,
                                    "Enabled": true,
                                    "OutputVariableName": "",
                                    "ContinueOnError": true,
                                    "SupportedEnv": "WinPEandFullOS",
                                    "SuccessCodes": "0 3010",
                                    "Timeout": null
                                  }
                                }
                              },
                              "3": {
                                "Name": "Customization",
                                "Type": "Group",
                                "Description": "",
                                "Condition": null,
                                "Enabled": true,
                                "ContinueOnError": true,
                                "Steps": {
                                  "1": {
                                    "Name": "Import WSUSCertificates",
                                    "Type": "RunCommandLineAction",
                                    "Action": "smsswd.exe /run:KOW00FFD Import-WSUSCertificates.cmd",
                                    "Description": "",
                                    "Conditions": "",
                                    "ExecutionPolicy": null,
                                    "PackageID": "KOW00FFD",
                                    "Parameters": null,
                                    "RunAsUser": false,
                                    "ScriptName": null,
                                    "SourceScript": null,
                                    "WorkingDirectory": null,
                                    "Enabled": true,
                                    "OutputVariableName": "",
                                    "ContinueOnError": true,
                                    "SupportedEnv": "WinPEandFullOS",
                                    "SuccessCodes": "0 3010",
                                    "Timeout": null
                                  },
                                  "2": {
                                    "Name": "Disable WindowsFeeds",
                                    "Type": "RunCommandLineAction",
                                    "Action": "smsswd.exe /run: reg add \"HKLM\\SOFTWARE\\Policies\\Microsoft\\Windows\\Windows Feeds\" /v EnableFeeds /t REG_DWORD /d 0",
                                    "Description": "",
                                    "Conditions": "",
                                    "ExecutionPolicy": null,
                                    "PackageID": null,
                                    "Parameters": null,
                                    "RunAsUser": false,
                                    "ScriptName": null,
                                    "SourceScript": null,
                                    "WorkingDirectory": null,
                                    "Enabled": true,
                                    "OutputVariableName": "",
                                    "ContinueOnError": true,
                                    "SupportedEnv": "WinPEandFullOS",
                                    "SuccessCodes": "0 3010",
                                    "Timeout": null
                                  }
                                }
                              }
                            }
                          },
                          "7": {
                            "Name": "Windows Setup",
                            "Type": "Group",
                            "Description": "",
                            "Condition": null,
                            "Enabled": true,
                            "ContinueOnError": true,
                            "Steps": {
                              "1": {
                                "Name": "Status 02.03 (Setup Windows)",
                                "Type": "SetVariableAction",
                                "Action": "tsenv.exe \"TSBStatus=General,Status02,Sub0203\" /hiddenflag:False",
                                "Description": "",
                                "Conditions": "",
                                "ExecutionPolicy": null,
                                "PackageID": null,
                                "Parameters": null,
                                "RunAsUser": null,
                                "ScriptName": null,
                                "SourceScript": null,
                                "WorkingDirectory": null,
                                "Enabled": true,
                                "OutputVariableName": null,
                                "ContinueOnError": false,
                                "SupportedEnv": "WinPEandFullOS",
                                "SuccessCodes": null,
                                "Timeout": null
                              },
                              "2": {
                                "Name": "CopyTSBToHdd",
                                "Type": "RunPowerShellScriptAction",
                                "Action": "OSDRunPowerShellScript.exe",
                                "Description": "",
                                "Conditions": "",
                                "ExecutionPolicy": "Bypass",
                                "PackageID": null,
                                "Parameters": "",
                                "RunAsUser": false,
                                "ScriptName": null,
                                "WorkingDirectory": "C:\\",
                                "Enabled": true,
                                "OutputVariableName": "",
                                "ContinueOnError": false,
                                "SupportedEnv": "WinPEandFullOS",
                                "SuccessCodes": "0",
                                "Timeout": null
                              },
                              "3": {
                                "Name": "Setup Windows and Configuration Manager",
                                "Type": "SetupWindowsAndSMSAction",
                                "Action": "OSDSetupWindows.exe",
                                "Description": "Actions to setup Windows and Configuration Manager client",
                                "Conditions": "",
                                "ExecutionPolicy": null,
                                "PackageID": null,
                                "Parameters": null,
                                "RunAsUser": null,
                                "ScriptName": null,
                                "SourceScript": null,
                                "WorkingDirectory": null,
                                "Enabled": true,
                                "OutputVariableName": null,
                                "ContinueOnError": false,
                                "SupportedEnv": "WinPEandFullOS",
                                "SuccessCodes": null,
                                "Timeout": null
                              }
                            }
                          },
                          "8": {
                            "Name": "Set Task Sequence Variables",
                            "Type": "Group",
                            "Description": "Actions to capture files and settings in the original operating system",
                            "Condition": null,
                            "Enabled": true,
                            "ContinueOnError": false,
                            "Steps": {
                              "1": {
                                "Name": "Set TS KOWOS Finish Time",
                                "Type": "RunCommandLineAction",
                                "Action": "smsswd.exe /run: %windir%\\System32\\WindowsPowerShell\\v1.0\\powershell.exe -command \"& {$tsenv = New-Object -COMObject Microsoft.SMS.TSEnvironment; $tsenv.Value('SMSTS_FinishTSTime_KOWOS') = Get-Date -Format 'dd.MM.yyyy HH:mm:ss'}\"",
                                "Description": "To be used later to determine how long the TS ran",
                                "Conditions": "",
                                "ExecutionPolicy": null,
                                "PackageID": null,
                                "Parameters": null,
                                "RunAsUser": false,
                                "ScriptName": null,
                                "SourceScript": null,
                                "WorkingDirectory": null,
                                "Enabled": true,
                                "OutputVariableName": "",
                                "ContinueOnError": true,
                                "SupportedEnv": "WinPEandFullOS",
                                "SuccessCodes": "0 3010",
                                "Timeout": null
                              },
                              "2": {
                                "Name": "Set TS KOWOS Duration",
                                "Type": "RunPowerShellScriptAction",
                                "Action": "OSDRunPowerShellScript.exe",
                                "Description": "",
                                "Conditions": "",
                                "ExecutionPolicy": "Bypass",
                                "PackageID": null,
                                "Parameters": "-DurationName \"KOWOS\"",
                                "RunAsUser": false,
                                "ScriptName": null,
                                "WorkingDirectory": null,
                                "Enabled": true,
                                "OutputVariableName": "",
                                "ContinueOnError": false,
                                "SupportedEnv": "WinPEandFullOS",
                                "SuccessCodes": "0 3010",
                                "Timeout": null
                              }
                            }
                          }
                        }
                      }
                    }
                  }
                }
              }
            },
            "4": {
              "Name": "03 Dell BIOS & Driver Updates",
              "Type": "Group",
              "Description": "Scan mit DCU, ob BIOS und/oder Treiber Updates vorhanden sind. Installation, wenn vorhanden.",
              "Condition": null,
              "Enabled": true,
              "ContinueOnError": false,
              "Steps": {
                "1": {
                  "Name": "Status 03 (Dell Driver&BIOS)",
                  "Type": "SetVariableAction",
                  "Action": "tsenv.exe \"TSBStatus=General,Status03\" /hiddenflag:False",
                  "Description": "",
                  "Conditions": "",
                  "ExecutionPolicy": null,
                  "PackageID": null,
                  "Parameters": null,
                  "RunAsUser": null,
                  "ScriptName": null,
                  "SourceScript": null,
                  "WorkingDirectory": null,
                  "Enabled": true,
                  "OutputVariableName": null,
                  "ContinueOnError": false,
                  "SupportedEnv": "WinPEandFullOS",
                  "SuccessCodes": null,
                  "Timeout": null
                },
                "2": {
                  "Name": "Module | KOW | Dell | Driver&BIOS",
                  "Type": "SubTasksequence",
                  "Description": "",
                  "Condition": null,
                  "Enabled": true,
                  "SupportedEnv": "WinPEandFullOS",
                  "TSName": "KOW01130, Module | KOW | Dell | Driver&BIOS",
                  "TSPackageID": "KOW01130",
                  "TSReferenceApplications": "ScopeId_4ED62265-995A-4C61-B6C4-B35612A69EBB/Application_756f081d-38c2-4c18-9e05-fb7fccd46aff",
                  "TSReferencePackages": "KOW00BA1",
                  "TSReferenceSoftwareUpdates": "",
                  "ContinueOnError": false,
                  "SubTaskSequence": {
                    "1": {
                      "1": {
                        "Name": "Dell Driver&BIOS",
                        "Type": "Group",
                        "Description": "",
                        "Condition": null,
                        "Enabled": true,
                        "ContinueOnError": true,
                        "Steps": {
                          "1": {
                            "Name": "Set Task Sequence Variables",
                            "Type": "Group",
                            "Description": "Actions to capture files and settings in the original operating system",
                            "Condition": null,
                            "Enabled": true,
                            "ContinueOnError": false,
                            "Steps": {
                              "1": {
                                "Name": "Set TS KOWDellUpdate Start Time",
                                "Type": "RunCommandLineAction",
                                "Action": "smsswd.exe /run: %windir%\\System32\\WindowsPowerShell\\v1.0\\powershell.exe -command \"& {$tsenv = New-Object -COMObject Microsoft.SMS.TSEnvironment; $tsenv.Value('SMSTS_StartTSTime_KOWDellUpdate') = Get-Date -Format 'dd.MM.yyyy HH:mm:ss'}\"",
                                "Description": "To be used later to determine how long the TS ran",
                                "Conditions": "",
                                "ExecutionPolicy": null,
                                "PackageID": null,
                                "Parameters": null,
                                "RunAsUser": false,
                                "ScriptName": null,
                                "SourceScript": null,
                                "WorkingDirectory": null,
                                "Enabled": true,
                                "OutputVariableName": "",
                                "ContinueOnError": true,
                                "SupportedEnv": "WinPEandFullOS",
                                "SuccessCodes": "0 3010",
                                "Timeout": null
                              }
                            }
                          },
                          "2": {
                            "Name": "Dell Command Update",
                            "Type": "Group",
                            "Description": "",
                            "Condition": null,
                            "Enabled": true,
                            "ContinueOnError": true,
                            "Steps": {
                              "1": {
                                "Name": "Install DCU",
                                "Type": "Group",
                                "Description": "",
                                "Condition": null,
                                "Enabled": true,
                                "ContinueOnError": false,
                                "Steps": {
                                  "1": {
                                    "Name": "Status 0301 (Dell Driver&BIOS - Initialize)",
                                    "Type": "SetVariableAction",
                                    "Action": "tsenv.exe \"TSBStatus=General,Status03,Sub0301\" /hiddenflag:False",
                                    "Description": "",
                                    "Conditions": "",
                                    "ExecutionPolicy": null,
                                    "PackageID": null,
                                    "Parameters": null,
                                    "RunAsUser": null,
                                    "ScriptName": null,
                                    "SourceScript": null,
                                    "WorkingDirectory": null,
                                    "Enabled": true,
                                    "OutputVariableName": null,
                                    "ContinueOnError": false,
                                    "SupportedEnv": "WinPEandFullOS",
                                    "SuccessCodes": null,
                                    "Timeout": null
                                  },
                                  "2": {
                                    "Name": "Install Dell Command Update",
                                    "Type": "InstallApplicationAction",
                                    "Action": "smsappinstall.exe /app:ScopeId_4ED62265-995A-4C61-B6C4-B35612A69EBB/Application_756f081d-38c2-4c18-9e05-fb7fccd46aff /basevar: /continueOnError:False",
                                    "Description": "",
                                    "Conditions": "---I--If none of these conditions are true:--/I----CRLF----TAB----B--File Exists:--/B----CRLF----TAB----TAB--C:\\Program Files\\Dell\\CommandUpdate\\dcu-cli.exe",
                                    "ExecutionPolicy": null,
                                    "PackageID": null,
                                    "Parameters": null,
                                    "RunAsUser": null,
                                    "ScriptName": null,
                                    "SourceScript": null,
                                    "WorkingDirectory": null,
                                    "Enabled": true,
                                    "OutputVariableName": null,
                                    "ContinueOnError": false,
                                    "SupportedEnv": "FullOS",
                                    "SuccessCodes": null,
                                    "Timeout": null
                                  },
                                  "3": {
                                    "Name": "Computer neu starten",
                                    "Type": "RebootAction",
                                    "Action": "smsboot.exe /target:HD",
                                    "Description": "",
                                    "Conditions": "",
                                    "ExecutionPolicy": null,
                                    "PackageID": null,
                                    "Parameters": null,
                                    "RunAsUser": null,
                                    "ScriptName": null,
                                    "SourceScript": null,
                                    "WorkingDirectory": null,
                                    "Enabled": true,
                                    "OutputVariableName": null,
                                    "ContinueOnError": false,
                                    "SupportedEnv": "WinPEandFullOS",
                                    "SuccessCodes": null,
                                    "Timeout": null
                                  },
                                  "4": {
                                    "Name": "Set TSVar DCU Installed",
                                    "Type": "SetVariableAction",
                                    "Action": "tsenv.exe \"DCUInstalled=True\" /hiddenflag:False",
                                    "Description": "",
                                    "Conditions": "--B--File Exists:--/B----CRLF----TAB--C:\\Program Files\\Dell\\CommandUpdate\\dcu-cli.exe",
                                    "ExecutionPolicy": null,
                                    "PackageID": null,
                                    "Parameters": null,
                                    "RunAsUser": null,
                                    "ScriptName": null,
                                    "SourceScript": null,
                                    "WorkingDirectory": null,
                                    "Enabled": true,
                                    "OutputVariableName": null,
                                    "ContinueOnError": false,
                                    "SupportedEnv": "WinPEandFullOS",
                                    "SuccessCodes": null,
                                    "Timeout": null
                                  },
                                  "5": {
                                    "Name": "Set TS Var \"SMSTS_UpdateTime\"",
                                    "Type": "RunCommandLineAction",
                                    "Action": "smsswd.exe /run: powershell.exe -command \"&{$tsenv = New-Object -COMObject Microsoft.SMS.TSEnvironment; $tsenv.Value('SMSTS_UpdateTime') = Get-Date -Format yyyyMMddTHHmmss}\"",
                                    "Description": "Used to make the Logs unique if process runs more than once",
                                    "Conditions": "",
                                    "ExecutionPolicy": null,
                                    "PackageID": null,
                                    "Parameters": null,
                                    "RunAsUser": false,
                                    "ScriptName": null,
                                    "SourceScript": null,
                                    "WorkingDirectory": null,
                                    "Enabled": true,
                                    "OutputVariableName": "",
                                    "ContinueOnError": false,
                                    "SupportedEnv": "WinPEandFullOS",
                                    "SuccessCodes": "0 3010",
                                    "Timeout": null
                                  },
                                  "6": {
                                    "Name": "Make Folder DCU for Results",
                                    "Type": "RunCommandLineAction",
                                    "Action": "smsswd.exe /run: cmd.exe /c if Not Exist \"C:\\Temp\\DCU\" (md C:\\Temp\\DCU)",
                                    "Description": "This folder & Subfolder are used to Store the setting template xml files, along with the reports genearated by DCU",
                                    "Conditions": "",
                                    "ExecutionPolicy": null,
                                    "PackageID": null,
                                    "Parameters": null,
                                    "RunAsUser": false,
                                    "ScriptName": null,
                                    "SourceScript": null,
                                    "WorkingDirectory": null,
                                    "Enabled": true,
                                    "OutputVariableName": "",
                                    "ContinueOnError": false,
                                    "SupportedEnv": "WinPEandFullOS",
                                    "SuccessCodes": "0 3010",
                                    "Timeout": null
                                  },
                                  "7": {
                                    "Name": "Make Folder DCULogs for Logs",
                                    "Type": "RunCommandLineAction",
                                    "Action": "smsswd.exe /run: cmd.exe /c if Not Exist \"C:\\Temp\\DCULogs\" (md C:\\Temp\\DCULogs)",
                                    "Description": "This Folder Collects the XML Log Files and time stamps them for historical viewing",
                                    "Conditions": "",
                                    "ExecutionPolicy": null,
                                    "PackageID": null,
                                    "Parameters": null,
                                    "RunAsUser": false,
                                    "ScriptName": null,
                                    "SourceScript": null,
                                    "WorkingDirectory": null,
                                    "Enabled": true,
                                    "OutputVariableName": "",
                                    "ContinueOnError": false,
                                    "SupportedEnv": "WinPEandFullOS",
                                    "SuccessCodes": "0 3010",
                                    "Timeout": null
                                  }
                                }
                              },
                              "2": {
                                "Name": "Run DCU BIOS",
                                "Type": "Group",
                                "Description": "",
                                "Condition": null,
                                "Enabled": true,
                                "ContinueOnError": false,
                                "Steps": {
                                  "1": {
                                    "Name": "Status 0302 (Dell Driver&BIOS - BIOS Update)",
                                    "Type": "SetVariableAction",
                                    "Action": "tsenv.exe \"TSBStatus=General,Status03,Sub0302\" /hiddenflag:False",
                                    "Description": "",
                                    "Conditions": "",
                                    "ExecutionPolicy": null,
                                    "PackageID": null,
                                    "Parameters": null,
                                    "RunAsUser": null,
                                    "ScriptName": null,
                                    "SourceScript": null,
                                    "WorkingDirectory": null,
                                    "Enabled": true,
                                    "OutputVariableName": null,
                                    "ContinueOnError": false,
                                    "SupportedEnv": "WinPEandFullOS",
                                    "SuccessCodes": null,
                                    "Timeout": null
                                  },
                                  "2": {
                                    "Name": "Set TS Var \"SMSTS_BIOSStartTime\"",
                                    "Type": "RunCommandLineAction",
                                    "Action": "smsswd.exe /run: powershell.exe -command \"&{$tsenv = New-Object -COMObject Microsoft.SMS.TSEnvironment; $tsenv.Value('SMSTS_BIOSStartTime') = Get-Date -Format 'dd.MM.yyyy HH:mm:ss'}\"",
                                    "Description": "Creates Variable with Time, which will be used later to figure out the time taken for proces to run",
                                    "Conditions": "",
                                    "ExecutionPolicy": null,
                                    "PackageID": null,
                                    "Parameters": null,
                                    "RunAsUser": false,
                                    "ScriptName": null,
                                    "SourceScript": null,
                                    "WorkingDirectory": null,
                                    "Enabled": true,
                                    "OutputVariableName": "",
                                    "ContinueOnError": false,
                                    "SupportedEnv": "WinPEandFullOS",
                                    "SuccessCodes": "0 3010",
                                    "Timeout": null
                                  },
                                  "3": {
                                    "Name": "Run DCU Report BIOS",
                                    "Type": "Group",
                                    "Description": "",
                                    "Condition": null,
                                    "Enabled": true,
                                    "ContinueOnError": false,
                                    "Steps": {
                                      "1": {
                                        "Name": "Run Dell Command Update Report (BIOS)",
                                        "Type": "RunCommandLineAction",
                                        "Action": "smsswd.exe /run: dcu-cli.exe /scan -report=C:\\Temp\\DCU\\BIOS\\ -updateType=bios -outputLog=C:\\Temp\\DCULogs\\scanOutputBIOS.log -silent",
                                        "Description": "",
                                        "Conditions": "",
                                        "ExecutionPolicy": null,
                                        "PackageID": null,
                                        "Parameters": null,
                                        "RunAsUser": true,
                                        "ScriptName": null,
                                        "SourceScript": null,
                                        "WorkingDirectory": "C:\\Program Files\\Dell\\CommandUpdate",
                                        "Enabled": true,
                                        "OutputVariableName": "",
                                        "ContinueOnError": false,
                                        "SupportedEnv": "WinPEandFullOS",
                                        "SuccessCodes": "0 3010",
                                        "Timeout": null
                                      },
                                      "2": {
                                        "Name": "Pause",
                                        "Type": "RunCommandLineAction",
                                        "Action": "smsswd.exe /run: cmd.exe /c \"start /wait cmd.exe\"",
                                        "Description": "",
                                        "Conditions": "--B--Task Sequence Variable:--/B----CRLF----TAB--PAUSE equals TRUE",
                                        "ExecutionPolicy": null,
                                        "PackageID": null,
                                        "Parameters": null,
                                        "RunAsUser": false,
                                        "ScriptName": null,
                                        "SourceScript": null,
                                        "WorkingDirectory": null,
                                        "Enabled": true,
                                        "OutputVariableName": "",
                                        "ContinueOnError": true,
                                        "SupportedEnv": "WinPEandFullOS",
                                        "SuccessCodes": "0 3010",
                                        "Timeout": null
                                      }
                                    }
                                  },
                                  "4": {
                                    "Name": "Run DCU if BIOS Update exists",
                                    "Type": "Group",
                                    "Description": "",
                                    "Condition": null,
                                    "Enabled": true,
                                    "ContinueOnError": false,
                                    "Steps": {
                                      "1": {
                                        "Name": "Set TS Var CurrentBiosVer",
                                        "Type": "RunCommandLineAction",
                                        "Action": "smsswd.exe /run: powershell.exe -command \"&{$tsenv = New-Object -COMObject Microsoft.SMS.TSEnvironment; $tsenv.Value('CurrentBiosVer') = (Get-WmiObject win32_bios).SMBIOSBIOSVersion}\"",
                                        "Description": "Grabs Current BIOS Value to be recorded later",
                                        "Conditions": "",
                                        "ExecutionPolicy": null,
                                        "PackageID": null,
                                        "Parameters": null,
                                        "RunAsUser": false,
                                        "ScriptName": null,
                                        "SourceScript": null,
                                        "WorkingDirectory": null,
                                        "Enabled": true,
                                        "OutputVariableName": "",
                                        "ContinueOnError": false,
                                        "SupportedEnv": "WinPEandFullOS",
                                        "SuccessCodes": "0 3010",
                                        "Timeout": null
                                      },
                                      "2": {
                                        "Name": "Run Dell Command Update Install BIOS Updates",
                                        "Type": "RunCommandLineAction",
                                        "Action": "smsswd.exe /run: dcu-cli.exe /applyUpdates -updateType=bios -outputLog=C:\\Windows\\ccm\\logs\\DellBIOSUpdate.log -reboot=enable -silent",
                                        "Description": "",
                                        "Conditions": "",
                                        "ExecutionPolicy": null,
                                        "PackageID": null,
                                        "Parameters": null,
                                        "RunAsUser": true,
                                        "ScriptName": null,
                                        "SourceScript": null,
                                        "WorkingDirectory": "C:\\Program Files\\Dell\\CommandUpdate",
                                        "Enabled": true,
                                        "OutputVariableName": "",
                                        "ContinueOnError": true,
                                        "SupportedEnv": "WinPEandFullOS",
                                        "SuccessCodes": "0 3010",
                                        "Timeout": null
                                      },
                                      "3": {
                                        "Name": "Set TS Var NewBiosVer",
                                        "Type": "RunCommandLineAction",
                                        "Action": "smsswd.exe /run: powershell.exe -command \"&{$tsenv = New-Object -COMObject Microsoft.SMS.TSEnvironment; $tsenv.Value('NewBiosVer') = (Get-WmiObject win32_bios).SMBIOSBIOSVersion}\"",
                                        "Description": "Grabs BIOS Version installed, for reporting later",
                                        "Conditions": "",
                                        "ExecutionPolicy": null,
                                        "PackageID": null,
                                        "Parameters": null,
                                        "RunAsUser": false,
                                        "ScriptName": null,
                                        "SourceScript": null,
                                        "WorkingDirectory": null,
                                        "Enabled": true,
                                        "OutputVariableName": "",
                                        "ContinueOnError": false,
                                        "SupportedEnv": "WinPEandFullOS",
                                        "SuccessCodes": "0 3010",
                                        "Timeout": null
                                      }
                                    }
                                  },
                                  "5": {
                                    "Name": "Set TS Var \"SMSTS_BIOSFinishTime\"",
                                    "Type": "RunCommandLineAction",
                                    "Action": "smsswd.exe /run: powershell.exe -command \"&{$tsenv = New-Object -COMObject Microsoft.SMS.TSEnvironment; $tsenv.Value('SMSTS_BIOSFinishTime') = Get-Date -Format 'dd.MM.yyyy HH:mm:ss'}\"",
                                    "Description": "Creates Variable with Time, which will be used later to figure out the time taken for proces to run",
                                    "Conditions": "",
                                    "ExecutionPolicy": null,
                                    "PackageID": null,
                                    "Parameters": null,
                                    "RunAsUser": false,
                                    "ScriptName": null,
                                    "SourceScript": null,
                                    "WorkingDirectory": null,
                                    "Enabled": true,
                                    "OutputVariableName": "",
                                    "ContinueOnError": false,
                                    "SupportedEnv": "WinPEandFullOS",
                                    "SuccessCodes": "0 3010",
                                    "Timeout": null
                                  },
                                  "6": {
                                    "Name": "Pause",
                                    "Type": "RunCommandLineAction",
                                    "Action": "smsswd.exe /run: cmd.exe /c \"start /wait cmd.exe\"",
                                    "Description": "",
                                    "Conditions": "--B--Task Sequence Variable:--/B----CRLF----TAB--PAUSE equals TRUE",
                                    "ExecutionPolicy": null,
                                    "PackageID": null,
                                    "Parameters": null,
                                    "RunAsUser": false,
                                    "ScriptName": null,
                                    "SourceScript": null,
                                    "WorkingDirectory": null,
                                    "Enabled": true,
                                    "OutputVariableName": "",
                                    "ContinueOnError": true,
                                    "SupportedEnv": "WinPEandFullOS",
                                    "SuccessCodes": "0 3010",
                                    "Timeout": null
                                  }
                                }
                              },
                              "3": {
                                "Name": "Run DCU Drivers",
                                "Type": "Group",
                                "Description": "",
                                "Condition": null,
                                "Enabled": true,
                                "ContinueOnError": false,
                                "Steps": {
                                  "1": {
                                    "Name": "Status 0303 (Dell Driver&BIOS - Driver Update)",
                                    "Type": "SetVariableAction",
                                    "Action": "tsenv.exe \"TSBStatus=General,Status03,Sub0303\" /hiddenflag:False",
                                    "Description": "",
                                    "Conditions": "",
                                    "ExecutionPolicy": null,
                                    "PackageID": null,
                                    "Parameters": null,
                                    "RunAsUser": null,
                                    "ScriptName": null,
                                    "SourceScript": null,
                                    "WorkingDirectory": null,
                                    "Enabled": true,
                                    "OutputVariableName": null,
                                    "ContinueOnError": false,
                                    "SupportedEnv": "WinPEandFullOS",
                                    "SuccessCodes": null,
                                    "Timeout": null
                                  },
                                  "2": {
                                    "Name": "Set TS Var \"SMSTS_DriversStartTime\"",
                                    "Type": "RunCommandLineAction",
                                    "Action": "smsswd.exe /run: powershell.exe -command \"&{$tsenv = New-Object -COMObject Microsoft.SMS.TSEnvironment; $tsenv.Value('SMSTS_DriversStartTime') = Get-Date -Format 'dd.MM.yyyy HH:mm:ss'}\"",
                                    "Description": "Creates Variable with Time, which will be used later to figure out the time taken for proces to run",
                                    "Conditions": "",
                                    "ExecutionPolicy": null,
                                    "PackageID": null,
                                    "Parameters": null,
                                    "RunAsUser": false,
                                    "ScriptName": null,
                                    "SourceScript": null,
                                    "WorkingDirectory": null,
                                    "Enabled": true,
                                    "OutputVariableName": "",
                                    "ContinueOnError": false,
                                    "SupportedEnv": "WinPEandFullOS",
                                    "SuccessCodes": "0 3010",
                                    "Timeout": null
                                  },
                                  "3": {
                                    "Name": "Run DCU Report Drivers",
                                    "Type": "Group",
                                    "Description": "",
                                    "Condition": null,
                                    "Enabled": true,
                                    "ContinueOnError": false,
                                    "Steps": {
                                      "1": {
                                        "Name": "Run Dell Command Update Report (Drivers)",
                                        "Type": "RunCommandLineAction",
                                        "Action": "smsswd.exe /run: .\\dcu-cli /scan -report=C:\\Temp\\DCU\\Driver\\ -updateType=driver -outputLog=C:\\Temp\\DCULogs\\scanOutputDriver.log -silent",
                                        "Description": "",
                                        "Conditions": "",
                                        "ExecutionPolicy": null,
                                        "PackageID": null,
                                        "Parameters": null,
                                        "RunAsUser": false,
                                        "ScriptName": null,
                                        "SourceScript": null,
                                        "WorkingDirectory": "C:\\Program Files\\Dell\\CommandUpdate",
                                        "Enabled": true,
                                        "OutputVariableName": "",
                                        "ContinueOnError": false,
                                        "SupportedEnv": "WinPEandFullOS",
                                        "SuccessCodes": "0 3010",
                                        "Timeout": null
                                      },
                                      "2": {
                                        "Name": "Pause",
                                        "Type": "RunCommandLineAction",
                                        "Action": "smsswd.exe /run: cmd.exe /c \"start /wait cmd.exe\"",
                                        "Description": "",
                                        "Conditions": "--B--Task Sequence Variable:--/B----CRLF----TAB--PAUSE equals TRUE",
                                        "ExecutionPolicy": null,
                                        "PackageID": null,
                                        "Parameters": null,
                                        "RunAsUser": false,
                                        "ScriptName": null,
                                        "SourceScript": null,
                                        "WorkingDirectory": null,
                                        "Enabled": true,
                                        "OutputVariableName": "",
                                        "ContinueOnError": true,
                                        "SupportedEnv": "WinPEandFullOS",
                                        "SuccessCodes": "0 3010",
                                        "Timeout": null
                                      }
                                    }
                                  },
                                  "4": {
                                    "Name": "Run DCU if Driver Update exists",
                                    "Type": "Group",
                                    "Description": "",
                                    "Condition": null,
                                    "Enabled": true,
                                    "ContinueOnError": false,
                                    "Steps": {
                                      "1": {
                                        "Name": "Run Dell Command Update Install Driver Updates",
                                        "Type": "RunCommandLineAction",
                                        "Action": "smsswd.exe /run: .\\dcu-cli /applyUpdates -updateType=driver -outputLog=C:\\Windows\\ccm\\logs\\DellDriverUpdate.log -reboot=enable -silent",
                                        "Description": "",
                                        "Conditions": "",
                                        "ExecutionPolicy": null,
                                        "PackageID": null,
                                        "Parameters": null,
                                        "RunAsUser": false,
                                        "ScriptName": null,
                                        "SourceScript": null,
                                        "WorkingDirectory": "C:\\Program Files\\Dell\\CommandUpdate",
                                        "Enabled": true,
                                        "OutputVariableName": "",
                                        "ContinueOnError": true,
                                        "SupportedEnv": "WinPEandFullOS",
                                        "SuccessCodes": "0 3010",
                                        "Timeout": null
                                      }
                                    }
                                  },
                                  "5": {
                                    "Name": "Set TS Var \"SMSTS_DriversFinishTime\"",
                                    "Type": "RunCommandLineAction",
                                    "Action": "smsswd.exe /run: powershell.exe -command \"&{$tsenv = New-Object -COMObject Microsoft.SMS.TSEnvironment; $tsenv.Value('SMSTS_DriversFinishTime') = Get-Date -Format 'dd.MM.yyyy HH:mm:ss'}\"",
                                    "Description": "Creates Variable with Time, which will be used later to figure out the time taken for proces to run",
                                    "Conditions": "",
                                    "ExecutionPolicy": null,
                                    "PackageID": null,
                                    "Parameters": null,
                                    "RunAsUser": false,
                                    "ScriptName": null,
                                    "SourceScript": null,
                                    "WorkingDirectory": null,
                                    "Enabled": true,
                                    "OutputVariableName": "",
                                    "ContinueOnError": false,
                                    "SupportedEnv": "WinPEandFullOS",
                                    "SuccessCodes": "0 3010",
                                    "Timeout": null
                                  }
                                }
                              },
                              "4": {
                                "Name": "Record Results for Reporting",
                                "Type": "RunPowerShellScriptAction",
                                "Action": "OSDRunPowerShellScript.exe",
                                "Description": "Records BIOS Before & After Versions, and Time taken to update BIOS and Time to update Drivers. This is setup to work as Stand Alone Deployment, or inside (child TS) OSD / IPU, if you're using the WaaS Process I blogged about on GARYTOWN.COM",
                                "Conditions": "",
                                "ExecutionPolicy": "Bypass",
                                "PackageID": "KOW00BA1",
                                "Parameters": "-ID \"%SMSTS_Build%\" -WMI -Registry -Class \"%SetOSDInfoType%\" -Namespace \"Kostwein\"",
                                "RunAsUser": false,
                                "ScriptName": "Set-DCUInfo.ps1",
                                "SourceScript": null,
                                "WorkingDirectory": "",
                                "Enabled": true,
                                "OutputVariableName": "",
                                "ContinueOnError": false,
                                "SupportedEnv": "WinPEandFullOS",
                                "SuccessCodes": "0",
                                "Timeout": null
                              }
                            }
                          },
                          "3": {
                            "Name": "Set Task Sequence Variables",
                            "Type": "Group",
                            "Description": "Actions to capture files and settings in the original operating system",
                            "Condition": null,
                            "Enabled": true,
                            "ContinueOnError": false,
                            "Steps": {
                              "1": {
                                "Name": "Set TS KOWDellUpdate Finish Time",
                                "Type": "RunCommandLineAction",
                                "Action": "smsswd.exe /run: %windir%\\System32\\WindowsPowerShell\\v1.0\\powershell.exe -command \"& {$tsenv = New-Object -COMObject Microsoft.SMS.TSEnvironment; $tsenv.Value('SMSTS_FinishTSTime_KOWDellUpdate') = Get-Date -Format 'dd.MM.yyyy HH:mm:ss'}\"",
                                "Description": "To be used later to determine how long the TS ran",
                                "Conditions": "",
                                "ExecutionPolicy": null,
                                "PackageID": null,
                                "Parameters": null,
                                "RunAsUser": false,
                                "ScriptName": null,
                                "SourceScript": null,
                                "WorkingDirectory": null,
                                "Enabled": true,
                                "OutputVariableName": "",
                                "ContinueOnError": true,
                                "SupportedEnv": "WinPEandFullOS",
                                "SuccessCodes": "0 3010",
                                "Timeout": null
                              },
                              "2": {
                                "Name": "Set TS KOWDellUpdate Duration",
                                "Type": "RunPowerShellScriptAction",
                                "Action": "OSDRunPowerShellScript.exe",
                                "Description": "",
                                "Conditions": "",
                                "ExecutionPolicy": "Bypass",
                                "PackageID": null,
                                "Parameters": "-DurationName \"KOWDellUpdate\"",
                                "RunAsUser": false,
                                "ScriptName": null,
                                "WorkingDirectory": null,
                                "Enabled": true,
                                "OutputVariableName": "",
                                "ContinueOnError": false,
                                "SupportedEnv": "WinPEandFullOS",
                                "SuccessCodes": "0 3010",
                                "Timeout": null
                              }
                            }
                          },
                          "4": {
                            "Name": "Pause",
                            "Type": "RunCommandLineAction",
                            "Action": "smsswd.exe /run: cmd.exe /c \"start /wait cmd.exe\"",
                            "Description": "",
                            "Conditions": "--B--Task Sequence Variable:--/B----CRLF----TAB--PAUSE equals TRUE",
                            "ExecutionPolicy": null,
                            "PackageID": null,
                            "Parameters": null,
                            "RunAsUser": false,
                            "ScriptName": null,
                            "SourceScript": null,
                            "WorkingDirectory": null,
                            "Enabled": true,
                            "OutputVariableName": "",
                            "ContinueOnError": true,
                            "SupportedEnv": "WinPEandFullOS",
                            "SuccessCodes": "0 3010",
                            "Timeout": null
                          }
                        }
                      }
                    }
                  }
                }
              }
            },
            "5": {
              "Name": "04 Software Install",
              "Type": "Group",
              "Description": "",
              "Condition": null,
              "Enabled": true,
              "ContinueOnError": true,
              "Steps": {
                "1": {
                  "Name": "Status 04 (Install Applications)",
                  "Type": "SetVariableAction",
                  "Action": "tsenv.exe \"TSBStatus=General,Status04\" /hiddenflag:False",
                  "Description": "",
                  "Conditions": "",
                  "ExecutionPolicy": null,
                  "PackageID": null,
                  "Parameters": null,
                  "RunAsUser": null,
                  "ScriptName": null,
                  "SourceScript": null,
                  "WorkingDirectory": null,
                  "Enabled": true,
                  "OutputVariableName": null,
                  "ContinueOnError": false,
                  "SupportedEnv": "WinPEandFullOS",
                  "SuccessCodes": null,
                  "Timeout": null
                },
                "2": {
                  "Name": "Module | KOW | Software Installation",
                  "Type": "SubTasksequence",
                  "Description": "",
                  "Condition": null,
                  "Enabled": true,
                  "SupportedEnv": "WinPEandFullOS",
                  "TSName": "KOW00F39, Module | KOW | Software Installation",
                  "TSPackageID": "KOW00F39",
                  "TSReferenceApplications": "ScopeId_4ED62265-995A-4C61-B6C4-B35612A69EBB/Application_0292aff5-f626-4e64-bda2-5c2c155d0716,ScopeId_4ED62265-995A-4C61-B6C4-B35612A69EBB/Application_0660cbfc-bfb0-464c-a31a-a13d3998d925,ScopeId_4ED62265-995A-4C61-B6C4-B35612A69EBB/Application_0E2F6877-B19C-4753-B6C0-1DA5760FDFF8,ScopeId_4ED62265-995A-4C61-B6C4-B35612A69EBB/Application_317b0517-b1b4-499e-8467-e576b9294d37,ScopeId_4ED62265-995A-4C61-B6C4-B35612A69EBB/Application_4043f28c-d784-4544-af46-9b8057a21eca,ScopeId_4ED62265-995A-4C61-B6C4-B35612A69EBB/Application_44b0427e-0cb0-4cd9-bf15-51470885824a,ScopeId_4ED62265-995A-4C61-B6C4-B35612A69EBB/Application_4f1a6400-6d16-4eb6-8244-54e4302d7a32,ScopeId_4ED62265-995A-4C61-B6C4-B35612A69EBB/Application_5d61c680-93c0-4f1d-b287-1c662e40204a,ScopeId_4ED62265-995A-4C61-B6C4-B35612A69EBB/Application_5e0783f5-1efc-41a9-90d8-466daa9084df,ScopeId_4ED62265-995A-4C61-B6C4-B35612A69EBB/Application_756f081d-38c2-4c18-9e05-fb7fccd46aff,ScopeId_4ED62265-995A-4C61-B6C4-B35612A69EBB/Application_75e75e3c-c6c7-4842-886e-4acdf93f8788,ScopeId_4ED62265-995A-4C61-B6C4-B35612A69EBB/Application_c78a4b70-6aba-4471-9b84-722d8048fadc,ScopeId_4ED62265-995A-4C61-B6C4-B35612A69EBB/Application_de3f4fa5-abaf-45c5-95dc-8516717200d2,ScopeId_4ED62265-995A-4C61-B6C4-B35612A69EBB/Application_f621a9d9-a77e-479c-9b8a-48dcd71402fd,ScopeId_4ED62265-995A-4C61-B6C4-B35612A69EBB/Application_f787643d-5c2d-4065-addd-101d0cc3e7fc",
                  "TSReferencePackages": "KOW0000B:Cisco Amp Client,KOW00280:Install,KOW00281:Install,KOW0030B:Install,KOW003DD:Install",
                  "TSReferenceSoftwareUpdates": "",
                  "ContinueOnError": true,
                  "SubTaskSequence": {
                    "1": {
                      "1": {
                        "Name": "Software Install",
                        "Type": "Group",
                        "Description": "",
                        "Condition": null,
                        "Enabled": true,
                        "ContinueOnError": true,
                        "Steps": {
                          "1": {
                            "Name": "Set Task Sequence Variables",
                            "Type": "Group",
                            "Description": "Actions to capture files and settings in the original operating system",
                            "Condition": null,
                            "Enabled": true,
                            "ContinueOnError": true,
                            "Steps": {
                              "1": {
                                "Name": "Set TS KOWSoftware Start Time",
                                "Type": "RunCommandLineAction",
                                "Action": "smsswd.exe /run: %windir%\\System32\\WindowsPowerShell\\v1.0\\powershell.exe -command \"& {$tsenv = New-Object -COMObject Microsoft.SMS.TSEnvironment; $tsenv.Value('SMSTS_StartTSTime_KOWSoftware') = Get-Date -Format 'dd.MM.yyyy HH:mm:ss'}\"",
                                "Description": "To be used later to determine how long the TS ran",
                                "Conditions": "",
                                "ExecutionPolicy": null,
                                "PackageID": null,
                                "Parameters": null,
                                "RunAsUser": false,
                                "ScriptName": null,
                                "SourceScript": null,
                                "WorkingDirectory": null,
                                "Enabled": true,
                                "OutputVariableName": "",
                                "ContinueOnError": true,
                                "SupportedEnv": "WinPEandFullOS",
                                "SuccessCodes": "0 3010",
                                "Timeout": null
                              }
                            }
                          },
                          "2": {
                            "Name": "Software Installation",
                            "Type": "Group",
                            "Description": "",
                            "Condition": null,
                            "Enabled": true,
                            "ContinueOnError": true,
                            "Steps": {
                              "1": {
                                "Name": "Browser",
                                "Type": "Group",
                                "Description": "",
                                "Condition": null,
                                "Enabled": true,
                                "ContinueOnError": false,
                                "Steps": {
                                  "1": {
                                    "Name": "Install Microsoft Edge",
                                    "Type": "InstallApplicationAction",
                                    "Action": "smsappinstall.exe /app:ScopeId_4ED62265-995A-4C61-B6C4-B35612A69EBB/Application_317b0517-b1b4-499e-8467-e576b9294d37 /basevar: /continueOnError:True",
                                    "Description": "",
                                    "Conditions": "",
                                    "ExecutionPolicy": null,
                                    "PackageID": null,
                                    "Parameters": null,
                                    "RunAsUser": null,
                                    "ScriptName": null,
                                    "SourceScript": null,
                                    "WorkingDirectory": null,
                                    "Enabled": true,
                                    "OutputVariableName": null,
                                    "ContinueOnError": true,
                                    "SupportedEnv": "FullOS",
                                    "SuccessCodes": null,
                                    "Timeout": null
                                  },
                                  "2": {
                                    "Name": "Google Chrome x64",
                                    "Type": "InstallApplicationAction",
                                    "Action": "smsappinstall.exe /app:ScopeId_4ED62265-995A-4C61-B6C4-B35612A69EBB/Application_f621a9d9-a77e-479c-9b8a-48dcd71402fd /basevar: /continueOnError:True",
                                    "Description": "",
                                    "Conditions": "",
                                    "ExecutionPolicy": null,
                                    "PackageID": null,
                                    "Parameters": null,
                                    "RunAsUser": null,
                                    "ScriptName": null,
                                    "SourceScript": null,
                                    "WorkingDirectory": null,
                                    "Enabled": true,
                                    "OutputVariableName": null,
                                    "ContinueOnError": true,
                                    "SupportedEnv": "FullOS",
                                    "SuccessCodes": null,
                                    "Timeout": null
                                  }
                                }
                              },
                              "2": {
                                "Name": "Restart Computer",
                                "Type": "RebootAction",
                                "Action": "smsboot.exe /target:HD",
                                "Description": "",
                                "Conditions": "",
                                "ExecutionPolicy": null,
                                "PackageID": null,
                                "Parameters": null,
                                "RunAsUser": null,
                                "ScriptName": null,
                                "SourceScript": null,
                                "WorkingDirectory": null,
                                "Enabled": true,
                                "OutputVariableName": null,
                                "ContinueOnError": false,
                                "SupportedEnv": "WinPEandFullOS",
                                "SuccessCodes": null,
                                "Timeout": null
                              },
                              "3": {
                                "Name": "MS Office 2019",
                                "Type": "Group",
                                "Description": "",
                                "Condition": null,
                                "Enabled": true,
                                "ContinueOnError": false,
                                "Steps": {
                                  "1": {
                                    "Name": "Install Office 2019 ProPlus 64Bit",
                                    "Type": "InstallApplicationAction",
                                    "Action": "smsappinstall.exe /app:ScopeId_4ED62265-995A-4C61-B6C4-B35612A69EBB/Application_f787643d-5c2d-4065-addd-101d0cc3e7fc /basevar: /continueOnError:True",
                                    "Description": "",
                                    "Conditions": "--B--Task Sequence Variable:--/B----CRLF----TAB--KOSOffice_Version equals Office2019_Pro_64",
                                    "ExecutionPolicy": null,
                                    "PackageID": null,
                                    "Parameters": null,
                                    "RunAsUser": null,
                                    "ScriptName": null,
                                    "SourceScript": null,
                                    "WorkingDirectory": null,
                                    "Enabled": true,
                                    "OutputVariableName": null,
                                    "ContinueOnError": true,
                                    "SupportedEnv": "FullOS",
                                    "SuccessCodes": null,
                                    "Timeout": null
                                  },
                                  "2": {
                                    "Name": "Install Office 2019 Standard 64Bit",
                                    "Type": "InstallApplicationAction",
                                    "Action": "smsappinstall.exe /app:ScopeId_4ED62265-995A-4C61-B6C4-B35612A69EBB/Application_44b0427e-0cb0-4cd9-bf15-51470885824a /basevar: /continueOnError:True",
                                    "Description": "",
                                    "Conditions": "--B--Task Sequence Variable:--/B----CRLF----TAB--KOSOffice_Version equals Office2019_Std_64",
                                    "ExecutionPolicy": null,
                                    "PackageID": null,
                                    "Parameters": null,
                                    "RunAsUser": null,
                                    "ScriptName": null,
                                    "SourceScript": null,
                                    "WorkingDirectory": null,
                                    "Enabled": true,
                                    "OutputVariableName": null,
                                    "ContinueOnError": true,
                                    "SupportedEnv": "FullOS",
                                    "SuccessCodes": null,
                                    "Timeout": null
                                  }
                                }
                              },
                              "4": {
                                "Name": "Dell Software",
                                "Type": "Group",
                                "Description": "",
                                "Condition": null,
                                "Enabled": true,
                                "ContinueOnError": false,
                                "Steps": {
                                  "1": {
                                    "Name": "Dell Command Monitor",
                                    "Type": "InstallApplicationAction",
                                    "Action": "smsappinstall.exe /app:ScopeId_4ED62265-995A-4C61-B6C4-B35612A69EBB/Application_0E2F6877-B19C-4753-B6C0-1DA5760FDFF8 /basevar: /continueOnError:True",
                                    "Description": "",
                                    "Conditions": "",
                                    "ExecutionPolicy": null,
                                    "PackageID": null,
                                    "Parameters": null,
                                    "RunAsUser": null,
                                    "ScriptName": null,
                                    "SourceScript": null,
                                    "WorkingDirectory": null,
                                    "Enabled": true,
                                    "OutputVariableName": null,
                                    "ContinueOnError": true,
                                    "SupportedEnv": "FullOS",
                                    "SuccessCodes": null,
                                    "Timeout": null
                                  },
                                  "2": {
                                    "Name": "Dell Command Update UWD",
                                    "Type": "InstallApplicationAction",
                                    "Action": "smsappinstall.exe /app:ScopeId_4ED62265-995A-4C61-B6C4-B35612A69EBB/Application_756f081d-38c2-4c18-9e05-fb7fccd46aff /basevar: /continueOnError:True",
                                    "Description": "",
                                    "Conditions": "---I--If none of these conditions are true:--/I----CRLF----TAB----B--File Exists:--/B----CRLF----TAB----TAB--C:\\Program Files\\Dell\\CommandUpdate\\dcu-cli.exe",
                                    "ExecutionPolicy": null,
                                    "PackageID": null,
                                    "Parameters": null,
                                    "RunAsUser": null,
                                    "ScriptName": null,
                                    "SourceScript": null,
                                    "WorkingDirectory": null,
                                    "Enabled": true,
                                    "OutputVariableName": null,
                                    "ContinueOnError": true,
                                    "SupportedEnv": "FullOS",
                                    "SuccessCodes": null,
                                    "Timeout": null
                                  },
                                  "3": {
                                    "Name": "Restart Computer",
                                    "Type": "RebootAction",
                                    "Action": "smsboot.exe /target:HD",
                                    "Description": "",
                                    "Conditions": "",
                                    "ExecutionPolicy": null,
                                    "PackageID": null,
                                    "Parameters": null,
                                    "RunAsUser": null,
                                    "ScriptName": null,
                                    "SourceScript": null,
                                    "WorkingDirectory": null,
                                    "Enabled": true,
                                    "OutputVariableName": null,
                                    "ContinueOnError": false,
                                    "SupportedEnv": "WinPEandFullOS",
                                    "SuccessCodes": null,
                                    "Timeout": null
                                  }
                                }
                              },
                              "5": {
                                "Name": "Standard Tools",
                                "Type": "Group",
                                "Description": "",
                                "Condition": null,
                                "Enabled": true,
                                "ContinueOnError": false,
                                "Steps": {
                                  "1": {
                                    "Name": "7-Zip x64",
                                    "Type": "InstallApplicationAction",
                                    "Action": "smsappinstall.exe /app:ScopeId_4ED62265-995A-4C61-B6C4-B35612A69EBB/Application_de3f4fa5-abaf-45c5-95dc-8516717200d2 /basevar: /continueOnError:True",
                                    "Description": "",
                                    "Conditions": "",
                                    "ExecutionPolicy": null,
                                    "PackageID": null,
                                    "Parameters": null,
                                    "RunAsUser": null,
                                    "ScriptName": null,
                                    "SourceScript": null,
                                    "WorkingDirectory": null,
                                    "Enabled": true,
                                    "OutputVariableName": null,
                                    "ContinueOnError": true,
                                    "SupportedEnv": "FullOS",
                                    "SuccessCodes": null,
                                    "Timeout": null
                                  },
                                  "2": {
                                    "Name": "VLC Media Player",
                                    "Type": "InstallApplicationAction",
                                    "Action": "smsappinstall.exe /app:ScopeId_4ED62265-995A-4C61-B6C4-B35612A69EBB/Application_5e0783f5-1efc-41a9-90d8-466daa9084df /basevar: /continueOnError:True",
                                    "Description": "",
                                    "Conditions": "",
                                    "ExecutionPolicy": null,
                                    "PackageID": null,
                                    "Parameters": null,
                                    "RunAsUser": null,
                                    "ScriptName": null,
                                    "SourceScript": null,
                                    "WorkingDirectory": null,
                                    "Enabled": true,
                                    "OutputVariableName": null,
                                    "ContinueOnError": true,
                                    "SupportedEnv": "FullOS",
                                    "SuccessCodes": null,
                                    "Timeout": null
                                  },
                                  "3": {
                                    "Name": "IrfanView x64",
                                    "Type": "InstallApplicationAction",
                                    "Action": "smsappinstall.exe /app:ScopeId_4ED62265-995A-4C61-B6C4-B35612A69EBB/Application_0292aff5-f626-4e64-bda2-5c2c155d0716 /basevar: /continueOnError:True",
                                    "Description": "",
                                    "Conditions": "",
                                    "ExecutionPolicy": null,
                                    "PackageID": null,
                                    "Parameters": null,
                                    "RunAsUser": null,
                                    "ScriptName": null,
                                    "SourceScript": null,
                                    "WorkingDirectory": null,
                                    "Enabled": true,
                                    "OutputVariableName": null,
                                    "ContinueOnError": true,
                                    "SupportedEnv": "FullOS",
                                    "SuccessCodes": null,
                                    "Timeout": null
                                  },
                                  "4": {
                                    "Name": "Adobe Acrobat Reader DC",
                                    "Type": "InstallApplicationAction",
                                    "Action": "smsappinstall.exe /app:ScopeId_4ED62265-995A-4C61-B6C4-B35612A69EBB/Application_4043f28c-d784-4544-af46-9b8057a21eca /basevar: /continueOnError:True",
                                    "Description": "",
                                    "Conditions": "",
                                    "ExecutionPolicy": null,
                                    "PackageID": null,
                                    "Parameters": null,
                                    "RunAsUser": null,
                                    "ScriptName": null,
                                    "SourceScript": null,
                                    "WorkingDirectory": null,
                                    "Enabled": true,
                                    "OutputVariableName": null,
                                    "ContinueOnError": true,
                                    "SupportedEnv": "FullOS",
                                    "SuccessCodes": null,
                                    "Timeout": null
                                  },
                                  "5": {
                                    "Name": "Install Team Viewer",
                                    "Type": "InstallSoftwareAction",
                                    "Action": "smsswd.exe /pkg:KOW003DD /install /basevar: /continueOnError:",
                                    "Description": "",
                                    "Conditions": "",
                                    "ExecutionPolicy": null,
                                    "PackageID": "KOW003DD",
                                    "Parameters": null,
                                    "RunAsUser": null,
                                    "ScriptName": null,
                                    "SourceScript": null,
                                    "WorkingDirectory": null,
                                    "Enabled": true,
                                    "OutputVariableName": null,
                                    "ContinueOnError": true,
                                    "SupportedEnv": "FullOS",
                                    "SuccessCodes": null,
                                    "Timeout": null
                                  },
                                  "6": {
                                    "Name": "Asset Desk Agent",
                                    "Type": "InstallApplicationAction",
                                    "Action": "smsappinstall.exe /app:ScopeId_4ED62265-995A-4C61-B6C4-B35612A69EBB/Application_5d61c680-93c0-4f1d-b287-1c662e40204a /basevar: /continueOnError:True",
                                    "Description": "",
                                    "Conditions": "",
                                    "ExecutionPolicy": null,
                                    "PackageID": null,
                                    "Parameters": null,
                                    "RunAsUser": null,
                                    "ScriptName": null,
                                    "SourceScript": null,
                                    "WorkingDirectory": null,
                                    "Enabled": true,
                                    "OutputVariableName": null,
                                    "ContinueOnError": true,
                                    "SupportedEnv": "FullOS",
                                    "SuccessCodes": null,
                                    "Timeout": null
                                  }
                                }
                              },
                              "6": {
                                "Name": "Restart Computer",
                                "Type": "RebootAction",
                                "Action": "smsboot.exe /target:HD",
                                "Description": "",
                                "Conditions": "",
                                "ExecutionPolicy": null,
                                "PackageID": null,
                                "Parameters": null,
                                "RunAsUser": null,
                                "ScriptName": null,
                                "SourceScript": null,
                                "WorkingDirectory": null,
                                "Enabled": true,
                                "OutputVariableName": null,
                                "ContinueOnError": false,
                                "SupportedEnv": "WinPEandFullOS",
                                "SuccessCodes": null,
                                "Timeout": null
                              },
                              "7": {
                                "Name": "Security Applications",
                                "Type": "Group",
                                "Description": "",
                                "Condition": null,
                                "Enabled": true,
                                "ContinueOnError": false,
                                "Steps": {
                                  "1": {
                                    "Name": "Cisco",
                                    "Type": "Group",
                                    "Description": "",
                                    "Condition": null,
                                    "Enabled": true,
                                    "ContinueOnError": false,
                                    "Steps": {
                                      "1": {
                                        "Name": "Cisco Amp Client",
                                        "Type": "InstallSoftwareAction",
                                        "Action": "smsswd.exe /pkg:KOW0000B /install /basevar: /continueOnError:",
                                        "Description": "",
                                        "Conditions": "",
                                        "ExecutionPolicy": null,
                                        "PackageID": "KOW0000B",
                                        "Parameters": null,
                                        "RunAsUser": null,
                                        "ScriptName": null,
                                        "SourceScript": null,
                                        "WorkingDirectory": null,
                                        "Enabled": true,
                                        "OutputVariableName": null,
                                        "ContinueOnError": true,
                                        "SupportedEnv": "FullOS",
                                        "SuccessCodes": null,
                                        "Timeout": null
                                      },
                                      "2": {
                                        "Name": "Cisco Secure Endpoint",
                                        "Type": "InstallApplicationAction",
                                        "Action": "smsappinstall.exe /app:ScopeId_4ED62265-995A-4C61-B6C4-B35612A69EBB/Application_c78a4b70-6aba-4471-9b84-722d8048fadc /basevar: /continueOnError:True",
                                        "Description": "",
                                        "Conditions": "",
                                        "ExecutionPolicy": null,
                                        "PackageID": null,
                                        "Parameters": null,
                                        "RunAsUser": null,
                                        "ScriptName": null,
                                        "SourceScript": null,
                                        "WorkingDirectory": null,
                                        "Enabled": true,
                                        "OutputVariableName": null,
                                        "ContinueOnError": true,
                                        "SupportedEnv": "FullOS",
                                        "SuccessCodes": null,
                                        "Timeout": null
                                      },
                                      "3": {
                                        "Name": "Cisco AnyConnect",
                                        "Type": "InstallApplicationAction",
                                        "Action": "smsappinstall.exe /app:ScopeId_4ED62265-995A-4C61-B6C4-B35612A69EBB/Application_4f1a6400-6d16-4eb6-8244-54e4302d7a32 /basevar: /continueOnError:True",
                                        "Description": "",
                                        "Conditions": "",
                                        "ExecutionPolicy": null,
                                        "PackageID": null,
                                        "Parameters": null,
                                        "RunAsUser": null,
                                        "ScriptName": null,
                                        "SourceScript": null,
                                        "WorkingDirectory": null,
                                        "Enabled": true,
                                        "OutputVariableName": null,
                                        "ContinueOnError": true,
                                        "SupportedEnv": "FullOS",
                                        "SuccessCodes": null,
                                        "Timeout": null
                                      },
                                      "4": {
                                        "Name": "Restart Computer",
                                        "Type": "RebootAction",
                                        "Action": "smsboot.exe /target:HD",
                                        "Description": "",
                                        "Conditions": "",
                                        "ExecutionPolicy": null,
                                        "PackageID": null,
                                        "Parameters": null,
                                        "RunAsUser": null,
                                        "ScriptName": null,
                                        "SourceScript": null,
                                        "WorkingDirectory": null,
                                        "Enabled": true,
                                        "OutputVariableName": null,
                                        "ContinueOnError": false,
                                        "SupportedEnv": "WinPEandFullOS",
                                        "SuccessCodes": null,
                                        "Timeout": null
                                      }
                                    }
                                  },
                                  "2": {
                                    "Name": "Rapid7 Agent",
                                    "Type": "InstallApplicationAction",
                                    "Action": "smsappinstall.exe /app:ScopeId_4ED62265-995A-4C61-B6C4-B35612A69EBB/Application_0660cbfc-bfb0-464c-a31a-a13d3998d925 /basevar: /continueOnError:True",
                                    "Description": "",
                                    "Conditions": "",
                                    "ExecutionPolicy": null,
                                    "PackageID": null,
                                    "Parameters": null,
                                    "RunAsUser": null,
                                    "ScriptName": null,
                                    "SourceScript": null,
                                    "WorkingDirectory": null,
                                    "Enabled": true,
                                    "OutputVariableName": null,
                                    "ContinueOnError": true,
                                    "SupportedEnv": "FullOS",
                                    "SuccessCodes": null,
                                    "Timeout": null
                                  },
                                  "3": {
                                    "Name": "Malwarebytes Endpoint Agent",
                                    "Type": "InstallSoftwareAction",
                                    "Action": "smsswd.exe /pkg:KOW0030B /install /basevar: /continueOnError:",
                                    "Description": "",
                                    "Conditions": "",
                                    "ExecutionPolicy": null,
                                    "PackageID": "KOW0030B",
                                    "Parameters": null,
                                    "RunAsUser": null,
                                    "ScriptName": null,
                                    "SourceScript": null,
                                    "WorkingDirectory": null,
                                    "Enabled": true,
                                    "OutputVariableName": null,
                                    "ContinueOnError": true,
                                    "SupportedEnv": "FullOS",
                                    "SuccessCodes": null,
                                    "Timeout": null
                                  },
                                  "4": {
                                    "Name": "HX Agent",
                                    "Type": "InstallApplicationAction",
                                    "Action": "smsappinstall.exe /app:ScopeId_4ED62265-995A-4C61-B6C4-B35612A69EBB/Application_75e75e3c-c6c7-4842-886e-4acdf93f8788 /basevar: /continueOnError:True",
                                    "Description": "",
                                    "Conditions": "",
                                    "ExecutionPolicy": null,
                                    "PackageID": null,
                                    "Parameters": null,
                                    "RunAsUser": null,
                                    "ScriptName": null,
                                    "SourceScript": null,
                                    "WorkingDirectory": null,
                                    "Enabled": true,
                                    "OutputVariableName": null,
                                    "ContinueOnError": true,
                                    "SupportedEnv": "FullOS",
                                    "SuccessCodes": null,
                                    "Timeout": null
                                  },
                                  "5": {
                                    "Name": "McAfee Agent",
                                    "Type": "InstallSoftwareAction",
                                    "Action": "smsswd.exe /pkg:KOW00280 /install /basevar: /continueOnError:",
                                    "Description": "",
                                    "Conditions": "",
                                    "ExecutionPolicy": null,
                                    "PackageID": "KOW00280",
                                    "Parameters": null,
                                    "RunAsUser": null,
                                    "ScriptName": null,
                                    "SourceScript": null,
                                    "WorkingDirectory": null,
                                    "Enabled": true,
                                    "OutputVariableName": null,
                                    "ContinueOnError": true,
                                    "SupportedEnv": "FullOS",
                                    "SuccessCodes": null,
                                    "Timeout": null
                                  }
                                }
                              },
                              "8": {
                                "Name": "Wlan Config",
                                "Type": "InstallSoftwareAction",
                                "Action": "smsswd.exe /pkg:KOW00281 /install /basevar: /continueOnError:",
                                "Description": "",
                                "Conditions": "",
                                "ExecutionPolicy": null,
                                "PackageID": "KOW00281",
                                "Parameters": null,
                                "RunAsUser": null,
                                "ScriptName": null,
                                "SourceScript": null,
                                "WorkingDirectory": null,
                                "Enabled": true,
                                "OutputVariableName": null,
                                "ContinueOnError": true,
                                "SupportedEnv": "FullOS",
                                "SuccessCodes": null,
                                "Timeout": null
                              },
                              "9": {
                                "Name": "Windows Aktivieren",
                                "Type": "RunPowerShellScriptAction",
                                "Action": "OSDRunPowerShellScript.exe",
                                "Description": "",
                                "Conditions": "--B--Task Sequence Variable:--/B----CRLF----TAB--KOSWinVer notEquals Enterprise",
                                "ExecutionPolicy": "Bypass",
                                "PackageID": null,
                                "Parameters": "",
                                "RunAsUser": false,
                                "ScriptName": null,
                                "WorkingDirectory": "",
                                "Enabled": true,
                                "OutputVariableName": "",
                                "ContinueOnError": true,
                                "SupportedEnv": "WinPEandFullOS",
                                "SuccessCodes": "0 3010",
                                "Timeout": null
                              }
                            }
                          },
                          "3": {
                            "Name": "Set Task Sequence Variables",
                            "Type": "Group",
                            "Description": "",
                            "Condition": null,
                            "Enabled": true,
                            "ContinueOnError": false,
                            "Steps": {
                              "1": {
                                "Name": "Set TS KOWSoftware FinishTime",
                                "Type": "RunCommandLineAction",
                                "Action": "smsswd.exe /run: %windir%\\System32\\WindowsPowerShell\\v1.0\\powershell.exe -command \"& {$tsenv = New-Object -COMObject Microsoft.SMS.TSEnvironment; $tsenv.Value('SMSTS_FinishTSTime_KOWSoftware') = Get-Date -Format 'dd.MM.yyyy HH:mm:ss'}\"",
                                "Description": "To be used later to determine how long the TS ran",
                                "Conditions": "",
                                "ExecutionPolicy": null,
                                "PackageID": null,
                                "Parameters": null,
                                "RunAsUser": false,
                                "ScriptName": null,
                                "SourceScript": null,
                                "WorkingDirectory": null,
                                "Enabled": true,
                                "OutputVariableName": "",
                                "ContinueOnError": true,
                                "SupportedEnv": "WinPEandFullOS",
                                "SuccessCodes": "0 3010",
                                "Timeout": null
                              },
                              "2": {
                                "Name": "Set TS KOWSoftware Duration",
                                "Type": "RunPowerShellScriptAction",
                                "Action": "OSDRunPowerShellScript.exe",
                                "Description": "",
                                "Conditions": "",
                                "ExecutionPolicy": "Bypass",
                                "PackageID": null,
                                "Parameters": "-DurationName \"KOWSoftware\"",
                                "RunAsUser": false,
                                "ScriptName": null,
                                "WorkingDirectory": null,
                                "Enabled": true,
                                "OutputVariableName": "",
                                "ContinueOnError": false,
                                "SupportedEnv": "WinPEandFullOS",
                                "SuccessCodes": "0 3010",
                                "Timeout": null
                              },
                              "3": {
                                "Name": "Restart Computer",
                                "Type": "RebootAction",
                                "Action": "smsboot.exe /target:HD",
                                "Description": "",
                                "Conditions": "",
                                "ExecutionPolicy": null,
                                "PackageID": null,
                                "Parameters": null,
                                "RunAsUser": null,
                                "ScriptName": null,
                                "SourceScript": null,
                                "WorkingDirectory": null,
                                "Enabled": true,
                                "OutputVariableName": null,
                                "ContinueOnError": false,
                                "SupportedEnv": "WinPEandFullOS",
                                "SuccessCodes": null,
                                "Timeout": null
                              }
                            }
                          }
                        }
                      }
                    }
                  }
                }
              }
            },
            "6": {
              "Name": "05 Install Updates",
              "Type": "Group",
              "Description": "",
              "Condition": null,
              "Enabled": true,
              "ContinueOnError": false,
              "Steps": {
                "1": {
                  "Name": "Status 05 (Install Updates)",
                  "Type": "SetVariableAction",
                  "Action": "tsenv.exe \"TSBStatus=General,Status05\" /hiddenflag:False",
                  "Description": "",
                  "Conditions": "",
                  "ExecutionPolicy": null,
                  "PackageID": null,
                  "Parameters": null,
                  "RunAsUser": null,
                  "ScriptName": null,
                  "SourceScript": null,
                  "WorkingDirectory": null,
                  "Enabled": true,
                  "OutputVariableName": null,
                  "ContinueOnError": false,
                  "SupportedEnv": "WinPEandFullOS",
                  "SuccessCodes": null,
                  "Timeout": null
                },
                "2": {
                  "Name": "Set TS KOWUpdate Start Time",
                  "Type": "RunCommandLineAction",
                  "Action": "smsswd.exe /run: %windir%\\System32\\WindowsPowerShell\\v1.0\\powershell.exe -command \"& {$tsenv = New-Object -COMObject Microsoft.SMS.TSEnvironment; $tsenv.Value('SMSTS_StartTSTime_KOWUpdate') = Get-Date -Format 'dd.MM.yyyy HH:mm:ss'}\"",
                  "Description": "To be used later to determine how long the TS ran",
                  "Conditions": "",
                  "ExecutionPolicy": null,
                  "PackageID": null,
                  "Parameters": null,
                  "RunAsUser": false,
                  "ScriptName": null,
                  "SourceScript": null,
                  "WorkingDirectory": null,
                  "Enabled": true,
                  "OutputVariableName": "",
                  "ContinueOnError": true,
                  "SupportedEnv": "WinPEandFullOS",
                  "SuccessCodes": "0 3010",
                  "Timeout": null
                },
                "3": {
                  "Name": "Install Updates",
                  "Type": "InstallUpdateAction",
                  "Action": "TSInstallSWUpdate.exe /target:%SMSInstallUpdateTarget%",
                  "Description": "",
                  "Conditions": "--B--Task Sequence Variable:--/B----CRLF----TAB--_SMSTSMediaType notEquals FullMedia",
                  "ExecutionPolicy": null,
                  "PackageID": null,
                  "Parameters": null,
                  "RunAsUser": null,
                  "ScriptName": null,
                  "SourceScript": null,
                  "WorkingDirectory": null,
                  "Enabled": true,
                  "OutputVariableName": null,
                  "ContinueOnError": true,
                  "SupportedEnv": "FullOS",
                  "SuccessCodes": null,
                  "Timeout": null
                },
                "4": {
                  "Name": "Set TS KOWUpdate Finish Time",
                  "Type": "RunCommandLineAction",
                  "Action": "smsswd.exe /run: %windir%\\System32\\WindowsPowerShell\\v1.0\\powershell.exe -command \"& {$tsenv = New-Object -COMObject Microsoft.SMS.TSEnvironment; $tsenv.Value('SMSTS_FinishTSTime_KOWUpdate') = Get-Date -Format 'dd.MM.yyyy HH:mm:ss'}\"",
                  "Description": "To be used later to determine how long the TS ran",
                  "Conditions": "",
                  "ExecutionPolicy": null,
                  "PackageID": null,
                  "Parameters": null,
                  "RunAsUser": false,
                  "ScriptName": null,
                  "SourceScript": null,
                  "WorkingDirectory": null,
                  "Enabled": true,
                  "OutputVariableName": "",
                  "ContinueOnError": true,
                  "SupportedEnv": "WinPEandFullOS",
                  "SuccessCodes": "0 3010",
                  "Timeout": null
                },
                "5": {
                  "Name": "Set TS KOWUpdate Duration",
                  "Type": "RunPowerShellScriptAction",
                  "Action": "OSDRunPowerShellScript.exe",
                  "Description": "",
                  "Conditions": "",
                  "ExecutionPolicy": "Bypass",
                  "PackageID": null,
                  "Parameters": "-DurationName \"KOWUpdate\"",
                  "RunAsUser": false,
                  "ScriptName": null,
                  "WorkingDirectory": null,
                  "Enabled": true,
                  "OutputVariableName": "",
                  "ContinueOnError": false,
                  "SupportedEnv": "WinPEandFullOS",
                  "SuccessCodes": "0 3010",
                  "Timeout": null
                },
                "6": {
                  "Name": "Restart Computer",
                  "Type": "RebootAction",
                  "Action": "smsboot.exe /target:HD",
                  "Description": "",
                  "Conditions": "",
                  "ExecutionPolicy": null,
                  "PackageID": null,
                  "Parameters": null,
                  "RunAsUser": null,
                  "ScriptName": null,
                  "SourceScript": null,
                  "WorkingDirectory": null,
                  "Enabled": true,
                  "OutputVariableName": null,
                  "ContinueOnError": false,
                  "SupportedEnv": "WinPEandFullOS",
                  "SuccessCodes": null,
                  "Timeout": null
                }
              }
            },
            "7": {
              "Name": "06 Finalizing OS",
              "Type": "Group",
              "Description": "",
              "Condition": null,
              "Enabled": true,
              "ContinueOnError": false,
              "Steps": {
                "1": {
                  "Name": "Status 06 (Finalize OSD)",
                  "Type": "SetVariableAction",
                  "Action": "tsenv.exe \"TSBStatus=General,Status06\" /hiddenflag:False",
                  "Description": "",
                  "Conditions": "",
                  "ExecutionPolicy": null,
                  "PackageID": null,
                  "Parameters": null,
                  "RunAsUser": null,
                  "ScriptName": null,
                  "SourceScript": null,
                  "WorkingDirectory": null,
                  "Enabled": true,
                  "OutputVariableName": null,
                  "ContinueOnError": false,
                  "SupportedEnv": "WinPEandFullOS",
                  "SuccessCodes": null,
                  "Timeout": null
                },
                "2": {
                  "Name": "Module | KOW | Windows Customization",
                  "Type": "SubTasksequence",
                  "Description": "",
                  "Condition": null,
                  "Enabled": true,
                  "SupportedEnv": "WinPEandFullOS",
                  "TSName": "KOW010FF, Module | KOW | Windows Customization",
                  "TSPackageID": "KOW010FF",
                  "TSReferenceApplications": "",
                  "TSReferencePackages": "KOW00BAA,KOW011C7",
                  "TSReferenceSoftwareUpdates": "",
                  "ContinueOnError": false,
                  "SubTaskSequence": {
                    "1": {
                      "1": {
                        "Name": "Windows 10 Customization",
                        "Type": "Group",
                        "Description": "",
                        "Condition": null,
                        "Enabled": true,
                        "ContinueOnError": true,
                        "Steps": {
                          "1": {
                            "Name": "ConfigMgr Care and Feeding",
                            "Type": "Group",
                            "Description": "Fixs a bunch of little issues and makes things run smoother",
                            "Condition": null,
                            "Enabled": true,
                            "ContinueOnError": true,
                            "Steps": {
                              "1": {
                                "Name": "Set Power Scheme to High Performance",
                                "Type": "RunCommandLineAction",
                                "Action": "smsswd.exe /run: powercfg -setactive 8c5e7fda-e8bf-4a96-9a85-a6e23a8c635c",
                                "Description": "Runs the task sequence with maximum performance to improve responsiveness and decreasing total imaging time",
                                "Conditions": "",
                                "ExecutionPolicy": null,
                                "PackageID": null,
                                "Parameters": null,
                                "RunAsUser": false,
                                "ScriptName": null,
                                "SourceScript": null,
                                "WorkingDirectory": null,
                                "Enabled": true,
                                "OutputVariableName": "",
                                "ContinueOnError": false,
                                "SupportedEnv": "WinPEandFullOS",
                                "SuccessCodes": "0 3010",
                                "Timeout": null
                              },
                              "2": {
                                "Name": "Allow Command Line",
                                "Type": "RunCommandLineAction",
                                "Action": "smsswd.exe /run: cmd /c del %OSDisk%\\Windows\\Setup\\scripts\\DisableCMDRequest.TAG",
                                "Description": "This prevents command line from being launched, so we clear it to enable troubleshooting",
                                "Conditions": "---I--If all of these conditions are true:--/I----CRLF----TAB----B--File Exists:--/B----CRLF----TAB----TAB--c:\\Windows\\Setup\\scripts\\DisableCMDRequest.TAG",
                                "ExecutionPolicy": null,
                                "PackageID": null,
                                "Parameters": null,
                                "RunAsUser": false,
                                "ScriptName": null,
                                "SourceScript": null,
                                "WorkingDirectory": null,
                                "Enabled": true,
                                "OutputVariableName": "",
                                "ContinueOnError": false,
                                "SupportedEnv": "WinPEandFullOS",
                                "SuccessCodes": "0 3010",
                                "Timeout": null
                              },
                              "3": {
                                "Name": "Set CCM Service to Auto Start",
                                "Type": "RunCommandLineAction",
                                "Action": "smsswd.exe /run: sc config \"CcmExec\" start= auto",
                                "Description": "CCM defaults to Auto-Delayed, but CCMEval will set it to Auto.  We bump it to Auto which speeds up the service (and TS) starting up after a reboot.",
                                "Conditions": "",
                                "ExecutionPolicy": null,
                                "PackageID": null,
                                "Parameters": null,
                                "RunAsUser": false,
                                "ScriptName": null,
                                "SourceScript": null,
                                "WorkingDirectory": null,
                                "Enabled": true,
                                "OutputVariableName": "",
                                "ContinueOnError": true,
                                "SupportedEnv": "WinPEandFullOS",
                                "SuccessCodes": "0 3010",
                                "Timeout": null
                              },
                              "4": {
                                "Name": "WMI Service Settings",
                                "Type": "RunCommandLineAction",
                                "Action": "smsswd.exe /run:KOW00BAA reg import \".\\Registry_Windows10\\WMIServiceConfiguration.reg\"",
                                "Description": "Changes WMI to be in a higher level group so it starts sooner",
                                "Conditions": "",
                                "ExecutionPolicy": null,
                                "PackageID": "KOW00BAA",
                                "Parameters": null,
                                "RunAsUser": false,
                                "ScriptName": null,
                                "SourceScript": null,
                                "WorkingDirectory": null,
                                "Enabled": true,
                                "OutputVariableName": "",
                                "ContinueOnError": true,
                                "SupportedEnv": "WinPEandFullOS",
                                "SuccessCodes": "0 3010",
                                "Timeout": 900
                              },
                              "5": {
                                "Name": "Group Policy Service Settings",
                                "Type": "RunCommandLineAction",
                                "Action": "smsswd.exe /run:KOW00BAA reg import \".\\Registry_Windows10\\GroupPolicyServiceConfiguration.reg\"",
                                "Description": "Changes group policy to be a stand alone service.  This handles an issue where the very first logon fails.",
                                "Conditions": "",
                                "ExecutionPolicy": null,
                                "PackageID": "KOW00BAA",
                                "Parameters": null,
                                "RunAsUser": false,
                                "ScriptName": null,
                                "SourceScript": null,
                                "WorkingDirectory": null,
                                "Enabled": true,
                                "OutputVariableName": "",
                                "ContinueOnError": true,
                                "SupportedEnv": "WinPEandFullOS",
                                "SuccessCodes": "0 3010",
                                "Timeout": 900
                              },
                              "6": {
                                "Name": "PowerShell Default Policies",
                                "Type": "RunCommandLineAction",
                                "Action": "smsswd.exe /run:KOW00BAA reg import \".\\Registry_Windows10\\PowerShellDefaultPolicies.reg\"",
                                "Description": "Sets the default policies so that PowerShell scripts can run while Windows is being deployed.  Fixes issues with PowerShell scripts running and Application deployments that use PowerShell detection methods.",
                                "Conditions": "",
                                "ExecutionPolicy": null,
                                "PackageID": "KOW00BAA",
                                "Parameters": null,
                                "RunAsUser": false,
                                "ScriptName": null,
                                "SourceScript": null,
                                "WorkingDirectory": null,
                                "Enabled": true,
                                "OutputVariableName": "",
                                "ContinueOnError": true,
                                "SupportedEnv": "WinPEandFullOS",
                                "SuccessCodes": "0 3010",
                                "Timeout": 900
                              }
                            }
                          },
                          "2": {
                            "Name": "Windows Configuration",
                            "Type": "Group",
                            "Description": "",
                            "Condition": null,
                            "Enabled": true,
                            "ContinueOnError": true,
                            "Steps": {
                              "1": {
                                "Name": "Script: Install Dell BIOS Provider",
                                "Type": "RunPowerShellScriptAction",
                                "Action": "OSDRunPowerShellScript.exe",
                                "Description": "",
                                "Conditions": "",
                                "ExecutionPolicy": "Bypass",
                                "PackageID": "KOW011C7",
                                "Parameters": "",
                                "RunAsUser": false,
                                "ScriptName": "Install-DellBiosProvider.ps1",
                                "SourceScript": null,
                                "WorkingDirectory": null,
                                "Enabled": true,
                                "OutputVariableName": "",
                                "ContinueOnError": false,
                                "SupportedEnv": "WinPEandFullOS",
                                "SuccessCodes": "0 3010",
                                "Timeout": null
                              },
                              "2": {
                                "Name": "Script: Config WoL Settings",
                                "Type": "RunPowerShellScriptAction",
                                "Action": "OSDRunPowerShellScript.exe",
                                "Description": "Diese Script setzt WoL Einstellungen im BIOS und in Windows sowie der LAN-NIC",
                                "Conditions": "",
                                "ExecutionPolicy": "Bypass",
                                "PackageID": "KOW011C7",
                                "Parameters": "",
                                "RunAsUser": false,
                                "ScriptName": "WOL.ps1",
                                "SourceScript": null,
                                "WorkingDirectory": null,
                                "Enabled": true,
                                "OutputVariableName": "",
                                "ContinueOnError": false,
                                "SupportedEnv": "WinPEandFullOS",
                                "SuccessCodes": "0 3010",
                                "Timeout": null
                              },
                              "3": {
                                "Name": "Services",
                                "Type": "Group",
                                "Description": "",
                                "Condition": null,
                                "Enabled": true,
                                "ContinueOnError": true,
                                "Steps": {
                                  "1": {
                                    "Name": "Enable Win-RM",
                                    "Type": "RunCommandLineAction",
                                    "Action": "smsswd.exe /run: cmd /c winrm quickconfig -quiet",
                                    "Description": "",
                                    "Conditions": "",
                                    "ExecutionPolicy": null,
                                    "PackageID": null,
                                    "Parameters": null,
                                    "RunAsUser": false,
                                    "ScriptName": null,
                                    "SourceScript": null,
                                    "WorkingDirectory": null,
                                    "Enabled": true,
                                    "OutputVariableName": "",
                                    "ContinueOnError": true,
                                    "SupportedEnv": "WinPEandFullOS",
                                    "SuccessCodes": "0 3010",
                                    "Timeout": 900
                                  },
                                  "2": {
                                    "Name": "WMI Static Port",
                                    "Type": "RunCommandLineAction",
                                    "Action": "smsswd.exe /run: cmd /c winmgmt -standalonehost",
                                    "Description": "Sets WMI to run off a static port",
                                    "Conditions": "",
                                    "ExecutionPolicy": null,
                                    "PackageID": null,
                                    "Parameters": null,
                                    "RunAsUser": false,
                                    "ScriptName": null,
                                    "SourceScript": null,
                                    "WorkingDirectory": null,
                                    "Enabled": true,
                                    "OutputVariableName": "",
                                    "ContinueOnError": false,
                                    "SupportedEnv": "WinPEandFullOS",
                                    "SuccessCodes": "0 3010",
                                    "Timeout": 900
                                  },
                                  "3": {
                                    "Name": "WMI Firewall Exception",
                                    "Type": "RunCommandLineAction",
                                    "Action": "smsswd.exe /run: cmd /c netsh firewall add portopening TCP 24158 WMIFixedPort",
                                    "Description": "Adds a rule to the firewall to allow WMI connections",
                                    "Conditions": "",
                                    "ExecutionPolicy": null,
                                    "PackageID": null,
                                    "Parameters": null,
                                    "RunAsUser": false,
                                    "ScriptName": null,
                                    "SourceScript": null,
                                    "WorkingDirectory": null,
                                    "Enabled": true,
                                    "OutputVariableName": "",
                                    "ContinueOnError": false,
                                    "SupportedEnv": "WinPEandFullOS",
                                    "SuccessCodes": "0 3010",
                                    "Timeout": null
                                  }
                                }
                              },
                              "4": {
                                "Name": "DisableFirstLogonAnimation",
                                "Type": "RunCommandLineAction",
                                "Action": "smsswd.exe /run:KOW00BAA reg import \".\\Registry_Windows10\\DisableFirstLogonAnimation.reg\"",
                                "Description": "",
                                "Conditions": "",
                                "ExecutionPolicy": null,
                                "PackageID": "KOW00BAA",
                                "Parameters": null,
                                "RunAsUser": false,
                                "ScriptName": null,
                                "SourceScript": null,
                                "WorkingDirectory": null,
                                "Enabled": true,
                                "OutputVariableName": "",
                                "ContinueOnError": true,
                                "SupportedEnv": "WinPEandFullOS",
                                "SuccessCodes": "0 3010",
                                "Timeout": 900
                              }
                            }
                          }
                        }
                      }
                    }
                  }
                },
                "3": {
                  "Name": "Post Install",
                  "Type": "Group",
                  "Description": "",
                  "Condition": null,
                  "Enabled": true,
                  "ContinueOnError": false,
                  "Steps": {
                    "1": {
                      "Name": "Enable BitLocker",
                      "Type": "Group",
                      "Description": "",
                      "Condition": null,
                      "Enabled": true,
                      "ContinueOnError": false,
                      "Steps": {
                        "1": {
                          "Name": "Notebooks",
                          "Type": "Group",
                          "Description": "",
                          "Condition": null,
                          "Enabled": true,
                          "ContinueOnError": false,
                          "Steps": {
                            "1": {
                              "Name": "Enable BitLocker",
                              "Type": "EnableBitLockerAction",
                              "Action": "OSDBitLocker.exe /enable  /wait:False /mode:TPM /pwd:AD_CM /full:False /crypt:0 /ignoretpm:True",
                              "Description": "Enable BitLocker",
                              "Conditions": "--B--Task Sequence Variable:--/B----CRLF----TAB--_SMSTSWTG notEquals true",
                              "ExecutionPolicy": null,
                              "PackageID": null,
                              "Parameters": null,
                              "RunAsUser": null,
                              "ScriptName": null,
                              "SourceScript": null,
                              "WorkingDirectory": null,
                              "Enabled": true,
                              "OutputVariableName": null,
                              "ContinueOnError": true,
                              "SupportedEnv": "FullOS",
                              "SuccessCodes": null,
                              "Timeout": null
                            }
                          }
                        },
                        "2": {
                          "Name": "Vmware",
                          "Type": "Group",
                          "Description": "",
                          "Condition": null,
                          "Enabled": true,
                          "ContinueOnError": false,
                          "Steps": {
                            "1": {
                              "Name": "Enable BitLocker",
                              "Type": "EnableBitLockerAction",
                              "Action": "OSDBitLocker.exe /enable  /wait:False /mode:TPM /pwd:AD_CM /full:False /crypt:0 /ignoretpm:True",
                              "Description": "Enable BitLocker",
                              "Conditions": "--B--Task Sequence Variable:--/B----CRLF----TAB--_SMSTSWTG notEquals true",
                              "ExecutionPolicy": null,
                              "PackageID": null,
                              "Parameters": null,
                              "RunAsUser": null,
                              "ScriptName": null,
                              "SourceScript": null,
                              "WorkingDirectory": null,
                              "Enabled": true,
                              "OutputVariableName": null,
                              "ContinueOnError": true,
                              "SupportedEnv": "FullOS",
                              "SuccessCodes": null,
                              "Timeout": null
                            }
                          }
                        }
                      }
                    }
                  }
                }
              }
            },
            "8": {
              "Name": "Reboot after OSD",
              "Type": "SetVariableAction",
              "Action": "tsenv.exe \"SMSTSPostAction=cmd /c shutdown /r /t 30 /f\" /hiddenflag:False",
              "Description": "Set SMSTSPostAction (Restart)",
              "Conditions": "",
              "ExecutionPolicy": null,
              "PackageID": null,
              "Parameters": null,
              "RunAsUser": null,
              "ScriptName": null,
              "SourceScript": null,
              "WorkingDirectory": null,
              "Enabled": true,
              "OutputVariableName": null,
              "ContinueOnError": false,
              "SupportedEnv": "WinPEandFullOS",
              "SuccessCodes": null,
              "Timeout": null
            },
            "9": {
              "Name": "Set AllStepsSucceeded = True",
              "Type": "SetVariableAction",
              "Action": "tsenv.exe \"AllStepsSucceeded=True\" /hiddenflag:False",
              "Description": "",
              "Conditions": "",
              "ExecutionPolicy": null,
              "PackageID": null,
              "Parameters": null,
              "RunAsUser": null,
              "ScriptName": null,
              "SourceScript": null,
              "WorkingDirectory": null,
              "Enabled": true,
              "OutputVariableName": null,
              "ContinueOnError": false,
              "SupportedEnv": "WinPEandFullOS",
              "SuccessCodes": null,
              "Timeout": null
            }
          }
        },
        "2": {
          "Name": "Failure",
          "Type": "Group",
          "Description": "",
          "Condition": null,
          "Enabled": true,
          "ContinueOnError": true,
          "Steps": {
            "1": {
              "Name": "Set Error Variables",
              "Type": "SetDynamicVariablesAction",
              "Action": "OSDSetDynamicVariables.exe",
              "Description": "",
              "Conditions": "",
              "ExecutionPolicy": null,
              "PackageID": null,
              "Parameters": null,
              "RunAsUser": null,
              "ScriptName": null,
              "SourceScript": null,
              "WorkingDirectory": null,
              "Enabled": true,
              "OutputVariableName": null,
              "ContinueOnError": false,
              "SupportedEnv": "WinPEandFullOS",
              "SuccessCodes": null,
              "Timeout": null
            },
            "2": {
              "Name": "Set ErrorReturnCode (No code thrown)",
              "Type": "SetVariableAction",
              "Action": "tsenv.exe \"ErrorReturnCode=234\" /hiddenflag:False",
              "Description": "Sets a default code if no error code was returned",
              "Conditions": "---I--If any of these conditions are true:--/I----CRLF----TAB----B--Task Sequence Variable:--/B----CRLF----TAB----TAB--ErrorReturnCode notExists ",
              "ExecutionPolicy": null,
              "PackageID": null,
              "Parameters": null,
              "RunAsUser": null,
              "ScriptName": null,
              "SourceScript": null,
              "WorkingDirectory": null,
              "Enabled": true,
              "OutputVariableName": null,
              "ContinueOnError": false,
              "SupportedEnv": "WinPEandFullOS",
              "SuccessCodes": null,
              "Timeout": null
            },
            "3": {
              "Name": "Set SMSTSErrorDialogTimeout",
              "Type": "SetVariableAction",
              "Action": "tsenv.exe \"SMSTSErrorDialogTimeout=86400\" /hiddenflag:False",
              "Description": "Set the timeout to be 24 hours",
              "Conditions": "",
              "ExecutionPolicy": null,
              "PackageID": null,
              "Parameters": null,
              "RunAsUser": null,
              "ScriptName": null,
              "SourceScript": null,
              "WorkingDirectory": null,
              "Enabled": true,
              "OutputVariableName": null,
              "ContinueOnError": false,
              "SupportedEnv": "WinPEandFullOS",
              "SuccessCodes": null,
              "Timeout": null
            },
            "4": {
              "Name": "StatusError (Error)",
              "Type": "SetVariableAction",
              "Action": "tsenv.exe \"TSBStatus=Error\" /hiddenflag:False",
              "Description": "",
              "Conditions": "",
              "ExecutionPolicy": null,
              "PackageID": null,
              "Parameters": null,
              "RunAsUser": null,
              "ScriptName": null,
              "SourceScript": null,
              "WorkingDirectory": null,
              "Enabled": true,
              "OutputVariableName": null,
              "ContinueOnError": false,
              "SupportedEnv": "WinPEandFullOS",
              "SuccessCodes": null,
              "Timeout": null
            }
          }
        },
        "3": {
          "Name": "Success",
          "Type": "Group",
          "Description": "",
          "Condition": null,
          "Enabled": true,
          "ContinueOnError": true,
          "Steps": {
            "1": {
              "Name": "Status (Success)",
              "Type": "SetVariableAction",
              "Action": "tsenv.exe \"TSBStatus=Success\" /hiddenflag:False",
              "Description": "",
              "Conditions": "",
              "ExecutionPolicy": null,
              "PackageID": null,
              "Parameters": null,
              "RunAsUser": null,
              "ScriptName": null,
              "SourceScript": null,
              "WorkingDirectory": null,
              "Enabled": true,
              "OutputVariableName": null,
              "ContinueOnError": false,
              "SupportedEnv": "WinPEandFullOS",
              "SuccessCodes": null,
              "Timeout": null
            },
            "2": {
              "Name": "Set TS FinishTime",
              "Type": "RunCommandLineAction",
              "Action": "smsswd.exe /run: %windir%\\System32\\WindowsPowerShell\\v1.0\\powershell.exe -command \"& {$tsenv = New-Object -COMObject Microsoft.SMS.TSEnvironment; $tsenv.Value('SMSTS_FinishTSTime') = Get-Date -Format 'dd.MM.yyyy HH:mm:ss'}\"",
              "Description": "To be used later to determine how long the TS ran",
              "Conditions": "",
              "ExecutionPolicy": null,
              "PackageID": null,
              "Parameters": null,
              "RunAsUser": false,
              "ScriptName": null,
              "SourceScript": null,
              "WorkingDirectory": null,
              "Enabled": true,
              "OutputVariableName": "",
              "ContinueOnError": true,
              "SupportedEnv": "WinPEandFullOS",
              "SuccessCodes": "0 3010",
              "Timeout": null
            }
          }
        },
        "4": {
          "Name": "Finalize",
          "Type": "Group",
          "Description": "",
          "Condition": null,
          "Enabled": true,
          "ContinueOnError": false,
          "Steps": {
            "1": {
              "Name": "Netzwerkordner einbinden (Sources)",
              "Type": "ConnectNetworkFolderAction",
              "Action": "smsnetuse.exe %SMSConnectNetworkFolderPath%",
              "Description": "",
              "Conditions": "",
              "ExecutionPolicy": null,
              "PackageID": null,
              "Parameters": null,
              "RunAsUser": null,
              "ScriptName": null,
              "SourceScript": null,
              "WorkingDirectory": null,
              "Enabled": true,
              "OutputVariableName": null,
              "ContinueOnError": true,
              "SupportedEnv": "WinPEandFullOS",
              "SuccessCodes": null,
              "Timeout": null
            },
            "2": {
              "Name": "Script: OSD TS Results",
              "Type": "RunPowerShellScriptAction",
              "Action": "OSDRunPowerShellScript.exe",
              "Description": "",
              "Conditions": "",
              "ExecutionPolicy": "Bypass",
              "PackageID": null,
              "Parameters": "",
              "RunAsUser": false,
              "ScriptName": null,
              "WorkingDirectory": "",
              "Enabled": true,
              "OutputVariableName": "",
              "ContinueOnError": false,
              "SupportedEnv": "WinPEandFullOS",
              "SuccessCodes": "0 3010",
              "Timeout": null
            },
            "3": {
              "Name": "Script: Copy Logs to network share",
              "Type": "RunPowerShellScriptAction",
              "Action": "OSDRunPowerShellScript.exe",
              "Description": "Logdateien werden auf \\\\atklsccm\\sources$\\Logs\\$ComputerName kopiert.",
              "Conditions": "",
              "ExecutionPolicy": "Bypass",
              "PackageID": null,
              "Parameters": "",
              "RunAsUser": false,
              "ScriptName": null,
              "WorkingDirectory": "",
              "Enabled": true,
              "OutputVariableName": "",
              "ContinueOnError": false,
              "SupportedEnv": "WinPEandFullOS",
              "SuccessCodes": "0 3010",
              "Timeout": null
            },
            "4": {
              "Name": "TSBSuccessDialog",
              "Type": "RunPowerShellScriptAction",
              "Action": "OSDRunPowerShellScript.exe",
              "Description": "",
              "Conditions": "--B--Task Sequence Variable:--/B----CRLF----TAB--AllStepsSucceeded equals True",
              "ExecutionPolicy": "Bypass",
              "PackageID": null,
              "Parameters": "",
              "RunAsUser": false,
              "ScriptName": null,
              "WorkingDirectory": "",
              "Enabled": true,
              "OutputVariableName": "",
              "ContinueOnError": false,
              "SupportedEnv": "WinPEandFullOS",
              "SuccessCodes": "0",
              "Timeout": 300
            },
            "5": {
              "Name": "TSBErrorDialog neu",
              "Type": "RunPowerShellScriptAction",
              "Action": "OSDRunPowerShellScript.exe",
              "Description": "",
              "Conditions": "--B--Task Sequence Variable:--/B----CRLF----TAB--AllStepsSucceeded equals False",
              "ExecutionPolicy": "Bypass",
              "PackageID": null,
              "Parameters": "",
              "RunAsUser": false,
              "ScriptName": null,
              "WorkingDirectory": "",
              "Enabled": true,
              "OutputVariableName": "",
              "ContinueOnError": false,
              "SupportedEnv": "WinPEandFullOS",
              "SuccessCodes": "0",
              "Timeout": null
            },
            "6": {
              "Name": "Computer neu starten",
              "Type": "RebootAction",
              "Action": "smsboot.exe /target:HD",
              "Description": "",
              "Conditions": "",
              "ExecutionPolicy": null,
              "PackageID": null,
              "Parameters": null,
              "RunAsUser": null,
              "ScriptName": null,
              "SourceScript": null,
              "WorkingDirectory": null,
              "Enabled": true,
              "OutputVariableName": null,
              "ContinueOnError": false,
              "SupportedEnv": "WinPEandFullOS",
              "SuccessCodes": null,
              "Timeout": null
            }
          }
        }
      }
    }
  }
}
